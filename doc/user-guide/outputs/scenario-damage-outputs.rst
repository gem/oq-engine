Scenario Damage Outputs
=======================

The Scenario Damage Calculator produces the following output file for all loss types (amongst “structural”, 
“nonstructural”, “contents”, or “business_interruption”) for which a fragility model file was provided in the 
configuration file:

1. ``Event Damages``: this file contains the damage distribution statistics for each individual events generated by the scenario, for each event and for every GMPE specified in the job file. For each event, the total number of buildings in each damage state are listed in this file.
2. ``Average Asset Damages``: this file contains the damage distribution statistics for each of the individual assets defined in the Exposure Model that fall within the ``region`` and have a computed Ground Motion Field value available within the defined ``asset_hazard_distance``. For each asset, the mean number of buildings (``mean``) in each damage state are listed in this file.

In addition, if the OpenQuake-QGIS plugin is used for visualizing or exporting the results from a Scenario Damage 
Calculation, the following additional outputs can be exported:

3. ``dmg_by_tag``: this file contains the aggregated damage distribution statistics for each of the tags defined in the Exposure Model. For each tag, the mean number of buildings (``mean``) in each damage state are listed in this file.
4. ``dmg_total``: this file contains the aggregated damage distribution statistics for the entire portfolio of assets defined in the Exposure Model. The mean (``mean``) and associated standard deviation (``stddev``) of the total number of buildings in each damage state are listed in this file.

In addition to the above asset-level damage output file which is produced for all Scenario Damage calculations, the 
following output file is also produced for all loss types (amongst “structural”, “nonstructural”, “contents”, or 
“business_interruption”) for which a Consequence Model file was also provided in the configuration file:

5. ``Event Losses``: this file contains the scenario consequence statistics for each of the individual events generated by the scenario for every GMPE specified in the job file. For each event, the total consequences considering the entire portfolio of assets are listed in this file.
6. ``Average Asset Losses``: this file contains the scenario consequence statistics for each of the individual assets defined in the Exposure Model that fall within the ``region`` and have a computed Ground Motion Field value available within the defined ``asset_hazard_distance``. For each asset, the mean consequences (``mean``) and associated standard deviation (``stddev``) are listed in this file.

In addition, if the OpenQuake-QGIS plugin is used for visualizing or exporting the results from a Scenario Damage 
Calculation, the following additional outputs can be exported:

7. ``losses_by_tag``: this file contains the aggregated scenario consequence statistics for each of the tags defined in the Exposure Model. For each tag, the mean consequences (``mean``) and associated standard deviation (``stddev``) are listed in this file.
8. ``losses_total``: this file contains the aggregated scenario consequence statistics for the entire portfolio of assets defined in the Exposure Model. The mean consequences (``mean``) and associated standard deviation (``stddev``) are listed in this file.

If the calculation involves multiple Ground Motion Prediction Equations as described in Example 4 in Section Scenario 
Damage Calculator, separate output files are generated for each of the above outputs, for each of the different Ground 
Motion Prediction Equations used in the calculation.

These different output files for Scenario Damage calculations are described in more detail in the following subsections.

Scenario damage statistics
--------------------------

***********************
Event damage statistics
***********************

This output contains the total damage distribution statistics for each of the individual events generated for the 
scenario. An example output file for structural damage is shown in the file snippet in the table below.

Example of a scenario event damage distribution output file

+--------------+------------+---------+---------+---------+---------+---------+-----+
| **event_id** | **rlz_id** | **ds0** | **ds1** | **ds2** | **ds3** | **ds4** | ... |
+==============+============+=========+=========+=========+=========+=========+=====+
| 0            | 0          | 5       | 1       | 0       | 0       | 1       | ... |
+--------------+------------+---------+---------+---------+---------+---------+-----+
| 1            | 0          | 4       | 1       | 1       | 1       | 0       | ... |
+--------------+------------+---------+---------+---------+---------+---------+-----+
| 2            | 0          | 6       | 0       | 0       | 0       | 1       | ... |
+--------------+------------+---------+---------+---------+---------+---------+-----+
| ...          | ...        | ...     | ...     | ...     | ...     | ...     | ... |
+--------------+------------+---------+---------+---------+---------+---------+-----+
| 100          | 1          | 5       | 0       | 1       | 0       | 1       | ... |
+--------------+------------+---------+---------+---------+---------+---------+-----+
| 101          | 1          | 4       | 1       | 1       | 1       | 0       | ... |
+--------------+------------+---------+---------+---------+---------+---------+-----+
| 102          | 1          | 5       | 1       | 0       | 0       | 1       | ... |
+--------------+------------+---------+---------+---------+---------+---------+-----+
| ...          | ...        | ...     | ...     | ...     | ...     | ...     | ... |
+--------------+------------+---------+---------+---------+---------+---------+-----+

The output file lists the total number of buildings in each damage state for each simulated event for the scenario, for 
each GMPE specified in the job file.

***********************
Asset damage statistics
***********************

This output contains the damage distribution statistics for each of the individual assets defined in the Exposure Model 
that fall within the ``region`` and have a computed Ground Motion Field value available within the defined 
``asset_hazard_distance``. An example output file for structural damage is shown in the file snippet in the table below.

Example of a scenario asset damage distribution output file

+---------------+--------------+----------+---------+--------------+--------------+--------------+--------------+-----+
| **asset_ref** | **taxonomy** | **lon**  | **lat** | **ds0_mean** | **ds1_mean** | **ds2_mean** | **ds3_mean** | ... |
+===============+==============+==========+=========+==============+==============+==============+==============+=====+
| a1            | tax1         | -122.000 | 38.113  | 2.43E-01     | 6.60E-01     | 3.00E-02     | 0.00E+00     | ... |
+---------------+--------------+----------+---------+--------------+--------------+--------------+--------------+-----+
| a2            | tax2         | -122.114 | 38.113  | 8.18E-01     | 1.00E-01     | 8.00E-02     | 2.50E-03     | ... |
+---------------+--------------+----------+---------+--------------+--------------+--------------+--------------+-----+
| a3            | tax1         | -122.570 | 38.113  | 9.90E-01     | 1.00E-02     | 0.00E+00     | 0.00E+00     | ... |
+---------------+--------------+----------+---------+--------------+--------------+--------------+--------------+-----+
| a4            | tax3         | -122.000 | 38.000  | 3.93E-01     | 2.35E-01     | 2.95E-01     | 7.25E-02     | ... |
+---------------+--------------+----------+---------+--------------+--------------+--------------+--------------+-----+
| a5            | tax1         | -122.000 | 37.910  | 9.90E-01     | 0.00E+00     | 0.00E+00     | 0.00E+00     | ... |
+---------------+--------------+----------+---------+--------------+--------------+--------------+--------------+-----+
| a6            | tax2         | -122.000 | 38.225  | 4.08E-01     | 2.35E-01     | 1.73E-01     | 1.28E-01     | ... |
+---------------+--------------+----------+---------+--------------+--------------+--------------+--------------+-----+
| a7            | tax1         | -121.886 | 38.113  | 9.70E-01     | 2.00E-02     | 0.00E+00     | 0.00E+00     | ... |
+---------------+--------------+----------+---------+--------------+--------------+--------------+--------------+-----+

The output file lists the mean of the number of buildings in each damage state for each asset in the exposure model for 
all loss types (amongst ‘structural’’, “nonstructural”, “contents”, or “business_interruption”) for which a *Consequence 
Model* file was also provided in the configuration file in addition to the corresponding *Fragility Model* file.

************************
Damage statistics by tag
************************

If the OpenQuake-QGIS plugin is used for visualizing or exporting the results, the Scenario Damage calculator can also 
estimate the expected total number of buildings of a certain combination of tags in each damage state and made available 
for export as a csv file. This distribution of damage per building tag is depicted in the example output file snippet 
in the table below.

Example of a scenario damage distribution per tag output file

+--------------+-------------------------+-------------------------+-------------------------+-------------------------+-----+
| **taxonomy** | **structural ds0_mean** | **structural ds1_mean** | **structural ds2_mean** | **structural ds3_mean** | ... |
+==============+=========================+=========================+=========================+=========================+=====+
| wood         | 3,272.48                | 592.55                  | 479.19                  | 422.34                  | ... |
+--------------+-------------------------+-------------------------+-------------------------+-------------------------+-----+
| concrete     | 1,241.94                | 389.94                  | 272.69                  | 91.63                   | ... |
+--------------+-------------------------+-------------------------+-------------------------+-------------------------+-----+
| steel        | 460.72                  | 279.44                  | 152.18                  | 57.43                   | ... |
+--------------+-------------------------+-------------------------+-------------------------+-------------------------+-----+

The output file lists the mean of the total number of buildings in each damage state for each tag found in the exposure 
model for all loss types (amongst “structural”, “nonstructural”, “contents”, or “business_interruption”).

***********************
Total damage statistics
***********************

Finally, a total damage distribution output file can also be generated if the OpenQuake-QGIS plugin is used for 
visualizing or exporting the results from a Scenario Damage Calculation, which will contain the mean and standard 
deviation of the total number of buildings in each damage state, as illustrated in the example file in the table below.

Example of a scenario total damage distribution output file

+---------------+------------------+------------------+
| **loss_type** | **damage_state** | **damage_value** |
+===============+==================+==================+
| structural    | no_damage_mean   | 4,975.13         |
+---------------+------------------+------------------+
| structural    | ds1_mean         | 904.06           |
+---------------+------------------+------------------+
| structural    | ds2_mean         | 564.35           |
+---------------+------------------+------------------+
| structural    | ds3_mean         | 246.44           |
+---------------+------------------+------------------+
| structural    | ds4_mean         | 310.03           |
+---------------+------------------+------------------+

Scenario consequence statistics
-------------------------------

****************************
Asset consequence statistics
****************************

This output contains the consequences statistics for each of the individual assets defined in the *Exposure Model* that 
fall within the ``region`` and have a computed Ground Motion Field value available within the defined 
``asset_hazard_distance``. An example output file for structural damage consequences is shown in the table below.

Example of a scenario asset consequences output file

+---------------+------------+----------+------------------------+--------------------------+
| **asset_ref** | **lon**    | **lat**  | **nonstructural-mean** | **nonstructural-stddev** |
+===============+============+==========+========================+==========================+
| a3            | -122.57000 | 38.11300 | 428.29                 | 281.49                   |
+---------------+------------+----------+------------------------+--------------------------+
| a2            | -122.11400 | 38.11300 | 1220.84                | 1111.4                   |
+---------------+------------+----------+------------------------+--------------------------+
| a5            | -122.00000 | 37.91000 | 1390.59                | 859.10                   |
+---------------+------------+----------+------------------------+--------------------------+
| a4            | -122.00000 | 38.00000 | 2889.04                | 1663.33                  |
+---------------+------------+----------+------------------------+--------------------------+
| a1            | -122.00000 | 38.11300 | 3191.30                | 1707.41                  |
+---------------+------------+----------+------------------------+--------------------------+
| a6            | -122.00000 | 38.22500 | 3310.62                | 2069.87                  |
+---------------+------------+----------+------------------------+--------------------------+
| a7            | -121.86000 | 38.11300 | 1415.19                | 845.83                   |
+---------------+------------+----------+------------------------+--------------------------+

The output file lists consequence statistics for all loss types (amongst “structural”, “nonstructural”, “contents”, or 
“business_interruption”) for which a *Consequence Model* file was also provided in the configuration file in addition 
to the corresponding *Fragility Model* file.

****************************
Total consequence statistics
****************************

Finally, if the OpenQuake-QGIS plugin is used for visualizing or exporting the results from a Scenario Damage 
Calculation, a total consequences output file can also be generated, which will contain the mean and standard deviation 
of the total consequences for the selected scenario, as illustrated in the example shown in the table below.

Example of a scenario total consequences output file

+--------------------+---------------------+---------------------+-----------------------+
| **contents-mean**  | **contents-stdev**  | **structural-mean** | **structural-stddev** |
+====================+=====================+=====================+=======================+
| 13845.87           | 6517.61             | 2270.29             | 2440.90               |
+--------------------+---------------------+---------------------+-----------------------+