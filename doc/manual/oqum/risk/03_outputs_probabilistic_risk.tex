Probabilistic risk calculations can be run using either the Classical
Probabilistic Risk Calculator or the Stochastic Event-Based Probabilistic Risk
Calculator. The following set of outputs is generated by both calculators:

\begin{enumerate}

  \item \Verb+loss_curves+: loss exceedance curves describe the probabilities
    of exceeding a set of loss ratios or loss values, within a given time span
    (or investigation interval).

  \item \Verb+loss_map+: loss maps describe the loss (\Verb+value+) 
    that is exceeded at the selected probability of exceedance (\Verb+poE+)
    within the specified time period for all \glspl{asset} at each of the unique
    locations in the \gls{exposuremodel}.

\end{enumerate}

In addition, with the Stochastic Event-Based Probabilistic Risk
Calculator, it is also possible to calculate the following types of outputs:

\begin{enumerate}

  \item \Verb+agg_curve+: aggregate loss curves describe the exceedance 
    probabilities for a set of loss values for the entire portfolio of 
    \glspl{asset} defined in the \gls{exposuremodel}.

  \item \Verb+event_loss_table+: an event loss table contains the aggregate 
    loss across all \glspl{asset} in the \gls{exposuremodel} for each of the
    simulated \glspl{rupture} in the \glsdesc{acr:ses}.

\end{enumerate}



\subsection{Loss exceedance curves}
\label{subsec:loss_curves}

Loss exceedance curves describe the probabilities of exceeding a set of loss
ratios or loss values, within a given time span (or investigation interval).
Depending upon the type of calculator used and the options defined before
running a probabilistic risk calculation, one or more of the sets of loss
exceedance curves described in the following subsections will be generated for
all loss types (amongst ``structural'', ``nonstructural'', ``contents'',
``occupants'', or ``business\_interruption'') for which a vulnerability model
file was provided in the configuration file.

\subsubsection{Asset loss exceedance curves}
\label{subsubsec:asset_loss_curves}

Individual asset loss exceedance curves for ground-up losses are always
generated for the Classical Probabilistic Risk Calculator. On the other hand,
individual asset loss exceedance curves are not generated for the Stochastic
Event-Based Probabilistic Risk Calculator unless the parameter
``loss\_ratios'' is defined in the configuration file. The file snippet
included in Listing~\ref{lst:output_loss_curve_asset} shows an example asset
loss exceedance curve output file.

\begin{listing}[htbp]
  \inputminted[firstline=1,firstnumber=1,fontsize=\footnotesize,frame=single,bgcolor=lightgray]{xml}{oqum/risk/verbatim/output_loss_curve_asset.xml}
  \caption{Example asset loss exceedance curves}
  \label{lst:output_loss_curve_asset}
\end{listing}

Each \Verb+lossCurve+ is associated with a location (defined within the
\Verb+gml:Point+ attribute) and a reference to the \gls{asset}
(\Verb+assetRef+) whose loss exceedance probabilities are being represented.
Then, three lists of values are presented: the probabilities of exceedance
(\Verb+poE+), levels of absolute loss (\Verb+losses+) and percentages of loss
(\Verb+lossRatios+).

\subsubsection{Insured loss exceedance curves}
\label{subsubsec:insured_loss_curves}

If the exposure model used in the calculation included insurance limits and
deductibles for the assets and if the parameter \Verb+insured_losses+ was set
to \Verb+true+ in the configuration file, individual asset insured loss
exceedance curves will also be generated by the Classical Probabilistic Risk
Calculator. On the other hand, individual asset insured loss exceedance curves
will not be generated for the Stochastic Event-Based Probabilistic Risk
Calculator unless the parameter ``loss\_ratios'' is also defined in the
configuration file. The file format for an insured loss exceedance curve file
is identical to the individual asset loss exceedance curve output file
described in the subsection above and is not repeated here.

\subsubsection{Mean loss exceedance curves}
\label{subsubsec:mean_loss_curves}

For calculations involving multiple hazard branches, mean asset loss
exceedance curves are also generated for both the Classical Probabilistic Risk
Calculator and the Stochastic Event-Based Probabilistic Risk Calculator (if
the parameter ``loss\_ratios'' is defined in the configuration file). An
example output file containing mean asset loss exceedance curves is shown
in Listing~\ref{lst:output_loss_curve_mean}. Apart from the metadata section, the structure of the file is identical
to that of the individual asset loss exceedance curve output file.

\begin{listing}[htbp]
  \inputminted[firstline=1,firstnumber=1,fontsize=\footnotesize,frame=single,bgcolor=lightgray]{xml}{oqum/risk/verbatim/output_loss_curve_mean.xml}
  \caption{Example mean asset loss exceedance curves}
  \label{lst:output_loss_curve_mean}
\end{listing}

\subsubsection{Quantile loss exceedance curves}
\label{subsubsec:quantile_loss_curves}

For calculations involving multiple hazard branches, quantile asset loss
exceedance curves can also be generated for both the Classical Probabilistic
Risk Calculator and the Stochastic Event-Based Probabilistic Risk Calculator
(if the parameter ``loss\_ratios'' is defined in the configuration file). The
quantiles for which loss curves will be calculated should have been defined in
the job configuration file for the calculation using the parameter
\Verb+quantile_loss_curves+. An example output file containing mean asset loss
exceedance curves is shown in Listing~\ref{lst:output_loss_curve_quantile}. Apart from the metadata section, the
structure of the file is identical to that of the individual asset loss
exceedance curve output file.

\begin{listing}[htbp]
  \inputminted[firstline=1,firstnumber=1,fontsize=\footnotesize,frame=single,bgcolor=lightgray]{xml}{oqum/risk/verbatim/output_loss_curve_quantile.xml}
  \caption{Example quantile asset loss exceedance curves}
  \label{lst:output_loss_curve_quantile}
\end{listing}

\subsubsection{Aggregate loss exceedance curves}
\label{subsubsec:aggregate_loss_curves}

Aggregate loss exceedance curves are generated only by the Stochastic Event-
Based Probabilistic Risk Calculator and describe the probabilities of
exceedance of the total loss across the entire portfolio for a set of
loss values within a given time span (or investigation interval). An example aggregate loss exceedance curve file is shown in Listing~\ref{lst:output_loss_curve_aggregate}.

\begin{listing}[htbp]
  \inputminted[firstline=1,firstnumber=1,fontsize=\footnotesize,frame=single,bgcolor=lightgray]{xml}{oqum/risk/verbatim/output_loss_curve_aggregate.xml}
  \caption{Example aggregate loss exceedance curve}
  \label{lst:output_loss_curve_aggregate}
\end{listing}

Same as described previously for individual assets, aggregate insured loss
exceedance curves, mean aggregate loss exceedance curves, and quantile
aggregate loss exceedance curves will also be generated when relevant.


\subsection{Probabilistic loss maps}
\label{subsec:probabilistic_loss_map}

A probabilistic loss map contains the losses that have a specified probability
of exceedance within a given time span (or investigation interval) throughout
the region of interest. This result can be generated using either the
Stochastic Event-Based Probabilistic Risk Calculator or the Classical
Probabilistic Risk Calculator.

The file snippet included in Listing~\ref{lst:output_probabilistic_loss_map}
shows an example probabilistic loss map output file.

\begin{listing}[htbp]
  \inputminted[firstline=1,firstnumber=1,fontsize=\footnotesize,frame=single,bgcolor=lightgray]{xml}{oqum/risk/verbatim/output_probabilistic_loss_map.xml}
  \caption{Example probabilistic loss map}
  \label{lst:output_probabilistic_loss_map}
\end{listing}

The important attributes in a probabilistic loss map are described below:

\begin{itemize}

  \item \Verb+sourceModelTreePath+: this parameter specifies the seismic
    source model used in this particular branch of the logic tree

  \item \Verb+gsimTreePath+: this parameter specifies the combination of
    ground motion models used in this particular branch of the logic tree

  \item \Verb+lossType+: the type of losses that are being stored. This
    parameter is taken from the \gls{vulnerabilitymodel} that was used in the
    loss calculations (e.g. fatalities, economic loss).

  \item \Verb+investigationTime+: time span used to compute the probability of
    exceedance
  
  \item \Verb+poE+: parameter specifying the probability of exceedance (e.g. 0.1)

  \item \Verb+unit+: this attribute defines the units in which the losses are
    being measured (e.g. EUR).

  \item \Verb+node+: each loss map comprises various nodes, each node possibly
    containing a number of \glspl{asset}. The location of the node is defined
    by a latitude and longitude in decimal degrees within the field
    \Verb+gml:Point+. The mean loss (\Verb+mean+) and associated standard
    deviation (\Verb+stdDev+) for each \gls{asset} (identified by the parameter
    \Verb+assetRef+) is stored in the \Verb+loss+ field.

\end{itemize}


\subsection{Stochastic event loss tables}

The Stochastic Event-Based Probabilistic Risk Calculator will also produce an
aggregate event loss table. Each row of this table contains the rupture id,
and aggregated loss (sum of the losses from the collection of assets within
the region of interest), for each event in the stochastic event sets. The
rupture id listed in this table is linked with the rupture ids listed in the
stochastic event sets files.

The file snippet included in Table~\ref{output:event_loss_table_aggregate}
shows an example stochastic event loss table output file.

\input{oqum/risk/verbatim/output_event_loss_table_aggregate}


Asset event loss tables provide calculated losses for each of the assets in
the exposure model, for each event within the stochastic event sets. In these
tables, each row contains the rupture id, the asset id, magnitude and asset
loss. Note that only assets that sustain non-zero losses in a rupture are
listed in the asset event loss table. Considering that the amount of data
usually contained in an asset event loss table is substantial, this table is
not generated by default, unless individual asset loss curves are requested by
specifying a non-empty dictionary of `loss_ratios` in the job configuration file.
