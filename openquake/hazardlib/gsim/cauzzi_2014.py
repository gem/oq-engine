# coding: utf-8
# The Hazard Library
# Copyright (C) 2014, GEM Foundation
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as
# published by the Free Software Foundation, either version 3 of the
# License, or (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
"""
Module exports :class:`CauzziEtAl2014`,
               :class:`CauzziEtAl2014NoSOF`,
               :class:`CauzziEtAl2014FixedVs30`,
               :class:`CauzziEtAl2014FixedVs30NoSOF`,
               :class:`CauzziEtAl2014Eurocode8`,
               :class:`CauzziEtAl2014Eurocode8NoSOF`,
"""
from __future__ import division

import numpy as np
# standard acceleration of gravity in m/s**2
from scipy.constants import g

from openquake.hazardlib.gsim.base import CoeffsTable, GMPE
from openquake.hazardlib import const
from openquake.hazardlib.imt import PGA, PGV, SA


class CauzziEtAl2014(GMPE):
    """
    Implements GMPE developed by Carlo Cauzzi et al (2014) and published
    as C.Cauzzi, E. Faccioli, M. Vanini and A. Bianchini (2014) "Updated
    predictive equations for broadband (0.0 - 10.0 s) horizontal response
    spectra and peak ground motions, based on a global dataset of digital
    acceleration records", Bulletin of Earthquake Engineering, In Press

    Spectral acceleration (SA) values are obtained from displacement response
    spectrum  (DSR) values (as provided by the original equations) using the
    following formula ::

        SA = DSR * (2 * Ï€ / T) ** 2
    
    """
    #: Supported tectonic region type is active shallow crust,
    DEFINED_FOR_TECTONIC_REGION_TYPE = const.TRT.ACTIVE_SHALLOW_CRUST

    #: Supported intensity measure types are spectral acceleration, peak
    #: ground acceleration and peak ground velocity.
    #: The original paper provides coefficients for PGA and PGV, while SA
    #: is obtained from displacement response spectrum values.
    #: Coefficients for PGA are taken from the SA (0.01 s) spectral
    #: acceleration, as indicated in Page 11 (at the time of writing)
    #: of Cauzzi et al. (2014)
    DEFINED_FOR_INTENSITY_MEASURE_TYPES = set([
        PGA,
        PGV,
        SA
    ])

    #: Supported intensity measure component is the geometric mean of two
    #: horizontal components
    #: :attr:`~openquake.hazardlib.const.IMC.AVERAGE_HORIZONTAL`,
    DEFINED_FOR_INTENSITY_MEASURE_COMPONENT = const.IMC.AVERAGE_HORIZONTAL

    #: Supported standard deviation types are inter-event, intra-event and
    #: total
    DEFINED_FOR_STANDARD_DEVIATION_TYPES = set([
        const.StdDev.INTER_EVENT,
        const.StdDev.INTRA_EVENT,
        const.StdDev.TOTAL
    ])

    #: Required site parameter is only Vs30
    REQUIRES_SITES_PARAMETERS = set(('vs30', ))

    #: Required rupture parameters are magnitude and rake
    REQUIRES_RUPTURE_PARAMETERS = set(('rake', 'mag'))

    #: Required distance measure is Rrup,
    REQUIRES_DISTANCES = set(('rrup', ))

    def get_mean_and_stddevs(self, sites, rup, dists, imt, stddev_types):
        """
        See :meth:`superclass method
        <.base.GroundShakingIntensityModel.get_mean_and_stddevs>`
        for spec of input and result values.
        """
        # extract dictionaries of coefficients specific to required
        # intensity measure type
        C = self.COEFFS[imt]

        mean = self._compute_mean(C, rup, dists, sites, imt)

        stddevs = self._get_stddevs(C, stddev_types, sites.vs30.shape[0])

        return mean, stddevs

    def _compute_mean(self, C, rup, dists, sites, imt):
        """
        Returns the mean ground motion acceleration and velocity
        """
        mean = (self._get_magnitude_scaling_term(C, rup.mag) +
                self._get_distance_scaling_term(C, rup.mag, dists.rrup) +
                self._get_style_of_faulting_term(C, rup.rake) +
                self._get_site_amplification_term(C, sites.vs30))
        # convert from cm/s**2 to g for SA and from cm/s**2 to g for PGA (PGV
        # is already in cm/s) and also convert from base 10 to base e.
        if isinstance(imt, PGA):
            mean = np.log((10 ** mean) * ((2 * np.pi / 0.01) ** 2) *
                          1e-2 / g)
        elif isinstance(imt, SA):
            mean = np.log((10 ** mean) * ((2 * np.pi / imt.period) ** 2) *
                          1e-2 / g)
        else:
            mean = np.log(10 ** mean)

        return mean

    def _get_magnitude_scaling_term(self, C, mag):
        """
        Returns the magnitude term
        """
        return C["c1"] + (C["m1"] * mag) + (C["m2"] * (mag ** 2.))

    def _get_distance_scaling_term(self, C, mag, rrup):
        """
        Returns the distance scaling parameter
        """
        return (C["r1"] + C["r2"] * mag) * np.log10(rrup + C["r3"])

    def _get_style_of_faulting_term(self, C, rake):
        """
        Returns the style of faulting term. Cauzzi et al. determind SOF from
        the plunge of the B-, T- and P-axes. For consistency with existing
        GMPEs the Wells & Coppersmith model is preferred
        """
        if rake > -150.0 and rake <= -30.0:
            return C['fN']
        elif rake > 30.0 and rake <= 150.0:
            return C['fR']
        else:
            return C['fSS']

    def _get_site_amplification_term(self, C, vs30):
        """
        Returns the site amplification scaling term assuming
        period dependent reference vs30
        """
        return C["bV"] * np.log10(vs30 / C["VA"])

    def _get_stddevs(self, C, stddev_types, num_sites):
        """
        Return total standard deviation.
        """
        stddevs = []
        for stddev_type in stddev_types:
            assert stddev_type in self.DEFINED_FOR_STANDARD_DEVIATION_TYPES
            if stddev_type == const.StdDev.TOTAL:
                stddevs.append(np.log(10.0 ** C['sM']) + np.zeros(num_sites))
            elif stddev_type == const.StdDev.INTRA_EVENT:
                stddevs.append(np.log(10.0 ** C['f']) + np.zeros(num_sites))
            elif stddev_type == const.StdDev.INTER_EVENT:
                stddevs.append(np.log(10.0 ** C["tM"]) + np.zeros(num_sites))
        return stddevs

    #: Coefficient table constructed from the electronic suplements of the
    #: original paper.
    COEFFS = CoeffsTable(sa_damping=5, table="""\
    imt             c1        m1         m2         r1        r2         r3        sB        sC        sD         bV      bV800            VA         fN         fR        fSS         f         t         s        tM        sM
    pgv        0.44222   0.54822   -0.03195   -2.84578   0.24067    6.51697   0.19193   0.37062   0.49780   -0.69096   -0.75968     883.95654   -0.14333    0.01846    0.00499   0.23989   0.22130   0.32638   0.21494   0.32210
    pga       -2.19617   0.52375   -0.06094   -3.80190   0.35508   11.64156   0.21070   0.28251   0.28288   -0.31007   -0.70244    2319.18598   -0.02411    0.07246   -0.05632   0.25892   0.22145   0.34071   0.21622   0.33733
    0.01000   -2.19617   0.52375   -0.06094   -3.80190   0.35508   11.64156   0.21070   0.28251   0.28288   -0.31007   -0.70244    2319.18598   -0.02411    0.07246   -0.05632   0.25892   0.22145   0.34071   0.21622   0.33733
    0.02000   -1.81957   0.64537   -0.07188   -3.86449   0.35932   12.13501   0.19924   0.26576   0.25978   -0.28384   -0.66974    2528.80503   -0.02723    0.07709   -0.05900   0.25927   0.22664   0.34436   0.22083   0.34057
    0.03000   -1.29436   0.69827   -0.07956   -4.04435   0.37652   13.31546   0.17812   0.23160   0.21528   -0.22882   -0.61914    3228.41863   -0.03333    0.08359   -0.06205   0.26104   0.23294   0.34986   0.22622   0.34542
    0.04000   -0.69311   0.70887   -0.08461   -4.25696   0.39739   14.97013   0.18128   0.21829   0.18311   -0.15732   -0.60762    8228.73111   -0.03838    0.08985   -0.06550   0.26552   0.23708   0.35596   0.22936   0.35087
    0.05000   -0.17390   0.70383   -0.08755   -4.41553   0.41403   15.96341   0.16785   0.18633   0.13929   -0.10000   -0.56395   30552.32717   -0.03900    0.09603   -0.07068   0.27026   0.24236   0.36301   0.23377   0.35734
    0.06000    0.20698   0.69063   -0.08884   -4.49212   0.42330   16.19950   0.16276   0.16769   0.10260   -0.10000   -0.53674   23999.06953   -0.04909    0.10148   -0.07143   0.27506   0.24524   0.36851   0.23550   0.36210
    0.07000    0.56089   0.67561   -0.08886   -4.54403   0.42592   17.37899   0.16545   0.15958   0.08629   -0.10000   -0.52661   20327.55501   -0.05142    0.10470   -0.07344   0.27995   0.24899   0.37466   0.23881   0.36797
    0.08000    0.75873   0.66549   -0.08794   -4.53166   0.42019   18.14491   0.20829   0.19638   0.11730   -0.10000   -0.60087   37180.07136   -0.04357    0.10251   -0.07527   0.28597   0.24634   0.37744   0.23673   0.37124
    0.09000    0.78466   0.66467   -0.08633   -4.44311   0.40965   17.79406   0.20581   0.20055   0.12392   -0.10000   -0.59993   36947.87877   -0.03861    0.10027   -0.07546   0.28797   0.24551   0.37842   0.23639   0.37256
    0.10000    0.67594   0.67016   -0.08425   -4.29897   0.39502   16.94994   0.19823   0.20041   0.13130   -0.10000   -0.59237   36597.56005   -0.02830    0.10057   -0.07995   0.28649   0.24334   0.37588   0.23433   0.37011
    0.15000    0.40604   0.63311   -0.07191   -3.86971   0.35272   13.75538   0.24891   0.30188   0.25319   -0.22732   -0.75495    5440.35206   -0.03000    0.09629   -0.07626   0.28885   0.23693   0.37359   0.22827   0.36816
    0.20000   -0.09647   0.63942   -0.06256   -3.41543   0.30101   11.45346   0.28214   0.40589   0.36909   -0.43845   -0.89444    1898.28570   -0.00367    0.06934   -0.06339   0.29325   0.21597   0.36420   0.21125   0.36142
    0.25000   -0.36474   0.64647   -0.05782   -3.19641   0.28216    9.36228   0.24732   0.40871   0.40913   -0.56473   -0.88696    1202.64389   -0.02305    0.06360   -0.05179   0.29578   0.20057   0.35738   0.19608   0.35487
    0.30000   -0.50661   0.66511   -0.05609   -3.09389   0.27352    8.29352   0.20965   0.40013   0.43355   -0.65541   -0.85457     967.92555   -0.01800    0.05087   -0.04177   0.29559   0.19908   0.35638   0.19615   0.35475
    0.35000   -0.66498   0.69532   -0.05579   -3.03494   0.26717    7.69133   0.20232   0.42138   0.48080   -0.74283   -0.87627     873.38167   -0.00557    0.04666   -0.04221   0.29822   0.20501   0.36189   0.20272   0.36060
    0.40000   -1.02453   0.74771   -0.05627   -2.88529   0.25368    6.21199   0.18582   0.41073   0.52099   -0.81009   -0.85303     794.55322    0.00041    0.04039   -0.03849   0.29878   0.20686   0.36340   0.20517   0.36244
    0.45000   -1.17672   0.78079   -0.05763   -2.84275   0.25137    5.64841   0.18870   0.41645   0.58079   -0.87518   -0.86429     759.83994    0.01422    0.03079   -0.03454   0.29805   0.20771   0.36328   0.20666   0.36269
    0.50000   -1.36997   0.82603   -0.06010   -2.79376   0.24835    5.20211   0.19121   0.41638   0.61638   -0.91661   -0.87612     747.10634    0.00868    0.02813   -0.02979   0.29883   0.21714   0.36939   0.21634   0.36892
    0.55000   -1.55323   0.88412   -0.06361   -2.77747   0.24613    5.27489   0.19226   0.42080   0.64732   -0.94899   -0.88733     734.26112    0.00799    0.02626   -0.02762   0.29885   0.22622   0.37481   0.22554   0.37440
    0.60000   -1.75107   0.94565   -0.06767   -2.76600   0.24598    5.23265   0.18566   0.41514   0.66854   -0.98493   -0.88180     707.08862    0.00742    0.02143   -0.02280   0.29697   0.23121   0.37636   0.23076   0.37609
    0.65000   -1.88122   0.99892   -0.07148   -2.78221   0.24813    5.15303   0.16946   0.40499   0.68145   -1.01531   -0.85948     681.46140    0.01964    0.01505   -0.02157   0.29546   0.23520   0.37764   0.23484   0.37743
    0.70000   -2.00114   1.04148   -0.07438   -2.80158   0.25152    5.12145   0.16758   0.40847   0.69706   -1.03828   -0.86282     673.96919    0.02598    0.00784   -0.01734   0.29606   0.23154   0.37585   0.23123   0.37565
    0.75000   -2.03150   1.06127   -0.07614   -2.84119   0.25837    5.05140   0.16810   0.40321   0.70806   -1.03136   -0.85797     675.69794    0.02393    0.00744   -0.01617   0.29516   0.22970   0.37401   0.22943   0.37384
    0.80000   -2.07133   1.08084   -0.07718   -2.84934   0.25950    5.09282   0.15442   0.38450   0.70078   -1.02313   -0.82637     657.20618    0.02140    0.00595   -0.01382   0.29244   0.23006   0.37208   0.22985   0.37195
    0.85000   -2.12629   1.10186   -0.07833   -2.85890   0.26066    5.09360   0.15046   0.37925   0.69694   -1.01448   -0.81378     653.81253    0.02111    0.00190   -0.00995   0.29283   0.23096   0.37295   0.23078   0.37284
    0.90000   -2.20739   1.13188   -0.08033   -2.87081   0.26166    5.12333   0.15446   0.38373   0.70122   -1.00936   -0.82102     662.24399    0.02890   -0.00198   -0.00939   0.29463   0.23263   0.37539   0.23230   0.37519
    0.95000   -2.36188   1.17734   -0.08311   -2.85892   0.25917    5.12452   0.16066   0.39195   0.70319   -1.00299   -0.83564     676.66342    0.03229   -0.00430   -0.00851   0.29599   0.23104   0.37549   0.23062   0.37523
    1.00000   -2.48787   1.21348   -0.08543   -2.85438   0.25937    4.97808   0.15767   0.39033   0.69326   -0.98919   -0.82480     678.61227    0.03447   -0.00544   -0.00830   0.29632   0.23075   0.37557   0.23026   0.37527
    1.05000   -2.60777   1.25860   -0.08916   -2.86981   0.26203    5.01070   0.15688   0.39261   0.68598   -0.97872   -0.81829     683.90149    0.03429   -0.00842   -0.00547   0.29568   0.23098   0.37520   0.23046   0.37488
    1.10000   -2.62838   1.27243   -0.09030   -2.89573   0.26581    5.06805   0.15520   0.39118   0.67923   -0.96566   -0.80785     685.93100    0.03437   -0.01108   -0.00315   0.29497   0.23506   0.37717   0.23449   0.37682
    1.15000   -2.59132   1.26481   -0.08941   -2.92124   0.26950    5.13234   0.14998   0.38534   0.66793   -0.95082   -0.79032     687.38032    0.03425   -0.01239   -0.00195   0.29347   0.23631   0.37679   0.23572   0.37642
    1.20000   -2.54603   1.25372   -0.08811   -2.93364   0.27069    5.26212   0.14670   0.38201   0.65489   -0.93291   -0.77276     688.27701    0.03949   -0.01407   -0.00252   0.29204   0.23733   0.37631   0.23654   0.37582
    1.25000   -2.55580   1.25980   -0.08840   -2.94364   0.27213    5.33342   0.14501   0.37993   0.64498   -0.92051   -0.76076     685.76052    0.04208   -0.01487   -0.00282   0.29203   0.23752   0.37643   0.23663   0.37587
    1.30000   -2.58213   1.27342   -0.08931   -2.95778   0.27350    5.43995   0.14301   0.37814   0.63681   -0.90996   -0.75371     685.35201    0.04261   -0.01581   -0.00215   0.29238   0.23747   0.37666   0.23653   0.37607
    1.35000   -2.62387   1.28932   -0.09025   -2.96503   0.27364    5.54729   0.14402   0.38307   0.63345   -0.90505   -0.75720     691.12873    0.04396   -0.01736   -0.00124   0.29288   0.23705   0.37679   0.23602   0.37615
    1.40000   -2.68975   1.31897   -0.09247   -2.98400   0.27531    5.70097   0.14004   0.38039   0.62377   -0.89742   -0.74699     689.84833    0.04271   -0.01772   -0.00039   0.29308   0.23660   0.37667   0.23559   0.37603
    1.45000   -2.77638   1.35624   -0.09515   -2.99792   0.27550    5.94070   0.13484   0.37520   0.61543   -0.89171   -0.73465     684.49344    0.03887   -0.01696    0.00046   0.29335   0.23552   0.37619   0.23466   0.37565
    1.50000   -2.82394   1.37033   -0.09534   -2.98721   0.27234    6.09930   0.12798   0.36959   0.60455   -0.88586   -0.72026     676.46480    0.03223   -0.01537    0.00165   0.29396   0.23370   0.37554   0.23307   0.37514
    1.55000   -2.90588   1.39722   -0.09655   -2.97899   0.26905    6.28192   0.12287   0.36364   0.59550   -0.87583   -0.70856     670.97370    0.02409   -0.01278    0.00245   0.29380   0.23272   0.37481   0.23234   0.37457
    1.60000   -2.96975   1.42425   -0.09851   -2.99346   0.27022    6.45109   0.12067   0.35808   0.58753   -0.86203   -0.69746     669.33148    0.01925   -0.01059    0.00234   0.29367   0.23146   0.37392   0.23120   0.37376
    1.65000   -3.02859   1.45304   -0.10087   -3.01323   0.27237    6.65655   0.11620   0.35115   0.57502   -0.84623   -0.68163     663.63941    0.01439   -0.00910    0.00286   0.29292   0.22990   0.37236   0.22973   0.37226
    1.70000   -3.12245   1.48971   -0.10363   -3.02207   0.27256    6.86500   0.11428   0.34846   0.56561   -0.83510   -0.67387     660.37690    0.00678   -0.00737    0.00420   0.29190   0.22936   0.37123   0.22929   0.37119
    1.75000   -3.19987   1.52368   -0.10624   -3.03232   0.27227    7.14934   0.11416   0.34785   0.56082   -0.82889   -0.67347     659.89859   -0.00070   -0.00529    0.00518   0.29151   0.22786   0.36999   0.22783   0.36998
    1.80000   -3.26077   1.55130   -0.10817   -3.03437   0.27051    7.47770   0.11337   0.34476   0.55495   -0.82082   -0.66892     657.31268   -0.00618   -0.00387    0.00597   0.29135   0.22687   0.36926   0.22684   0.36924
    1.85000   -3.29098   1.56827   -0.10919   -3.03635   0.26880    7.83299   0.11312   0.34130   0.55106   -0.81358   -0.66353     654.01003   -0.00837   -0.00380    0.00676   0.29147   0.22549   0.36851   0.22544   0.36849
    1.90000   -3.33434   1.59160   -0.11069   -3.03755   0.26668    8.25080   0.10984   0.33541   0.54492   -0.80595   -0.65210     647.42662   -0.01042   -0.00346    0.00722   0.29117   0.22481   0.36786   0.22475   0.36782
    1.95000   -3.41085   1.62526   -0.11311   -3.03978   0.26499    8.64936   0.10739   0.32993   0.54050   -0.79836   -0.64265     643.84469   -0.01343   -0.00272    0.00768   0.29106   0.22420   0.36740   0.22412   0.36735
    2.00000   -3.48355   1.65630   -0.11541   -3.04422   0.26418    8.97465   0.10587   0.32567   0.53512   -0.79096   -0.63423     641.12234   -0.01624   -0.00200    0.00810   0.29064   0.22570   0.36799   0.22559   0.36792
    2.05000   -3.52030   1.67315   -0.11650   -3.04776   0.26348    9.24329   0.10417   0.32327   0.53066   -0.78687   -0.62748     637.71419   -0.01916   -0.00125    0.00852   0.29077   0.22641   0.36852   0.22626   0.36843
    2.10000   -3.54589   1.68458   -0.11712   -3.05154   0.26324    9.46251   0.10129   0.32091   0.52530   -0.78411   -0.61993     633.76275   -0.02232   -0.00011    0.00868   0.29078   0.22652   0.36859   0.22631   0.36847
    2.15000   -3.51998   1.67924   -0.11654   -3.05979   0.26396    9.67757   0.10208   0.32128   0.52271   -0.77900   -0.61785     636.04837   -0.02311    0.00005    0.00883   0.29082   0.22669   0.36873   0.22647   0.36860
    2.20000   -3.50314   1.67643   -0.11606   -3.06231   0.26355    9.93040   0.10278   0.32096   0.52074   -0.77392   -0.61601     638.09986   -0.02410    0.00055    0.00876   0.29051   0.22707   0.36872   0.22683   0.36857
    2.25000   -3.53275   1.68544   -0.11635   -3.05247   0.26141   10.16094   0.10240   0.31955   0.51785   -0.76888   -0.61212     638.15989   -0.02558    0.00136    0.00858   0.28984   0.22745   0.36843   0.22718   0.36826
    2.30000   -3.60342   1.70540   -0.11740   -3.03338   0.25815   10.31418   0.09956   0.31579   0.51215   -0.76471   -0.60390     633.54394   -0.02798    0.00311    0.00789   0.28910   0.22753   0.36789   0.22719   0.36769
    2.35000   -3.68619   1.72887   -0.11879   -3.01436   0.25517   10.42855   0.09789   0.31213   0.50854   -0.76071   -0.59607     629.76830   -0.02955    0.00436    0.00733   0.28863   0.22782   0.36770   0.22743   0.36747
    2.40000   -3.76890   1.75295   -0.12011   -2.99470   0.25151   10.60507   0.09740   0.30835   0.50697   -0.75593   -0.59006     627.24284   -0.03233    0.00608    0.00682   0.28778   0.22821   0.36729   0.22774   0.36699
    2.45000   -3.84949   1.77916   -0.12167   -2.97976   0.24834   10.80435   0.09453   0.30209   0.50135   -0.74817   -0.57898     622.77023   -0.03674    0.00847    0.00631   0.28699   0.22864   0.36693   0.22801   0.36654
    2.50000   -3.90026   1.79463   -0.12241   -2.96777   0.24585   10.97167   0.09307   0.29824   0.49625   -0.74155   -0.57157     621.65073   -0.04051    0.01000    0.00636   0.28603   0.22857   0.36614   0.22779   0.36566
    2.55000   -3.89945   1.79362   -0.12188   -2.96242   0.24440   11.18663   0.09484   0.29818   0.49537   -0.73713   -0.57019     625.78648   -0.04262    0.01031    0.00689   0.28481   0.22845   0.36511   0.22758   0.36457
    2.60000   -3.86982   1.78402   -0.12084   -2.96470   0.24441   11.35173   0.09761   0.29858   0.49647   -0.73326   -0.56987     630.55876   -0.04434    0.01057    0.00733   0.28379   0.22854   0.36437   0.22761   0.36379
    2.65000   -3.82495   1.76847   -0.11938   -2.97056   0.24532   11.45210   0.10113   0.30108   0.49912   -0.73242   -0.57346     635.96331   -0.04539    0.01090    0.00745   0.28292   0.22860   0.36374   0.22763   0.36312
    2.70000   -3.80109   1.75950   -0.11850   -2.97420   0.24620   11.52196   0.10288   0.30146   0.50077   -0.73182   -0.57310     637.51526   -0.04462    0.01112    0.00698   0.28211   0.22892   0.36330   0.22797   0.36270
    2.75000   -3.77755   1.75143   -0.11780   -2.98021   0.24751   11.58461   0.10550   0.30223   0.50387   -0.73120   -0.57404     640.52762   -0.04389    0.01137    0.00650   0.28148   0.22969   0.36331   0.22877   0.36272
    2.80000   -3.76752   1.74658   -0.11727   -2.98150   0.24810   11.64934   0.10739   0.30226   0.50559   -0.72925   -0.57380     643.06843   -0.04315    0.01156    0.00605   0.28134   0.23046   0.36369   0.22956   0.36312
    2.85000   -3.73742   1.73659   -0.11647   -2.98759   0.24954   11.71770   0.10985   0.30317   0.50700   -0.72663   -0.57423     646.55736   -0.04207    0.01146    0.00574   0.28124   0.23093   0.36390   0.23007   0.36336
    2.90000   -3.72850   1.73121   -0.11589   -2.98518   0.24993   11.74177   0.10928   0.30131   0.50503   -0.72336   -0.56831     644.99327   -0.04197    0.01152    0.00566   0.28121   0.23143   0.36420   0.23057   0.36365
    2.95000   -3.72935   1.73050   -0.11578   -2.98645   0.25087   11.77062   0.10877   0.29929   0.50233   -0.71909   -0.56191     643.84307   -0.04184    0.01144    0.00570   0.28119   0.23209   0.36460   0.23125   0.36407
    3.00000   -3.71812   1.72769   -0.11558   -2.99231   0.25238   11.83860   0.10820   0.29685   0.49837   -0.71271   -0.55475     643.30046   -0.04347    0.01153    0.00625   0.28126   0.23245   0.36488   0.23155   0.36431
    3.05000   -3.69563   1.72062   -0.11502   -2.99884   0.25394   11.91947   0.10867   0.29591   0.49485   -0.70685   -0.55050     645.21356   -0.04527    0.01151    0.00697   0.28147   0.23245   0.36504   0.23149   0.36443
    3.10000   -3.68132   1.71553   -0.11455   -3.00388   0.25519   12.00394   0.10901   0.29495   0.49264   -0.70262   -0.54692     645.89353   -0.04681    0.01157    0.00749   0.28183   0.23255   0.36539   0.23154   0.36475
    3.15000   -3.67758   1.71551   -0.11464   -3.01184   0.25694   12.07426   0.10914   0.29381   0.49002   -0.69805   -0.54289     645.78046   -0.04796    0.01184    0.00771   0.28188   0.23322   0.36585   0.23216   0.36517
    3.20000   -3.66593   1.71366   -0.11474   -3.02525   0.25985   12.10481   0.11009   0.29318   0.48849   -0.69400   -0.53969     646.19195   -0.04833    0.01181    0.00790   0.28159   0.23386   0.36604   0.23279   0.36535
    3.25000   -3.66842   1.71635   -0.11515   -3.03629   0.26227   12.15194   0.11040   0.29166   0.48671   -0.69001   -0.53554     645.49501   -0.04900    0.01166    0.00832   0.28113   0.23431   0.36597   0.23322   0.36527
    3.30000   -3.65687   1.71497   -0.11526   -3.04976   0.26504   12.18956   0.11103   0.28998   0.48496   -0.68509   -0.53134     645.71662   -0.04992    0.01153    0.00882   0.28036   0.23482   0.36571   0.23370   0.36499
    3.35000   -3.64062   1.71287   -0.11532   -3.06390   0.26772   12.25324   0.11183   0.28856   0.48378   -0.68087   -0.52743     646.17985   -0.05006    0.01120    0.00924   0.27928   0.23574   0.36547   0.23462   0.36475
    3.40000   -3.63206   1.71144   -0.11539   -3.07488   0.27018   12.27876   0.11288   0.28775   0.48310   -0.67774   -0.52491     647.36875   -0.04996    0.01058    0.00981   0.27831   0.23637   0.36514   0.23527   0.36443
    3.45000   -3.62771   1.70915   -0.11531   -3.08127   0.27215   12.26229   0.11381   0.28728   0.48181   -0.67448   -0.52218     649.24296   -0.05044    0.00995    0.01060   0.27744   0.23661   0.36463   0.23550   0.36391
    3.50000   -3.62410   1.70689   -0.11507   -3.08374   0.27302   12.28693   0.11421   0.28662   0.47950   -0.67061   -0.51896     650.57891   -0.05113    0.00950    0.01130   0.27665   0.23681   0.36416   0.23568   0.36343
    3.55000   -3.61631   1.70252   -0.11463   -3.08602   0.27391   12.31137   0.11530   0.28701   0.47793   -0.66784   -0.51779     652.89978   -0.05214    0.00905    0.01213   0.27593   0.23712   0.36381   0.23596   0.36306
    3.60000   -3.62944   1.70397   -0.11455   -3.08486   0.27417   12.32915   0.11619   0.28719   0.47545   -0.66385   -0.51570     655.62572   -0.05309    0.00855    0.01298   0.27545   0.23761   0.36377   0.23642   0.36300
    3.65000   -3.63981   1.70469   -0.11438   -3.08283   0.27417   12.35133   0.11633   0.28693   0.47283   -0.66047   -0.51331     657.08250   -0.05417    0.00834    0.01362   0.27508   0.23802   0.36376   0.23679   0.36296
    3.70000   -3.63959   1.70303   -0.11407   -3.08366   0.27452   12.39206   0.11607   0.28686   0.47000   -0.65741   -0.51079     658.04968   -0.05467    0.00822    0.01394   0.27465   0.23851   0.36376   0.23726   0.36294
    3.75000   -3.63098   1.70020   -0.11378   -3.08944   0.27560   12.45756   0.11670   0.28808   0.46838   -0.65545   -0.51052     660.23090   -0.05540    0.00823    0.01424   0.27413   0.23895   0.36366   0.23767   0.36281
    3.80000   -3.61948   1.69754   -0.11356   -3.09723   0.27689   12.54492   0.11705   0.28879   0.46630   -0.65366   -0.50974     661.36616   -0.05647    0.00842    0.01451   0.27355   0.23943   0.36353   0.23810   0.36265
    3.85000   -3.61310   1.69563   -0.11338   -3.10319   0.27811   12.60729   0.11694   0.28836   0.46361   -0.65096   -0.50750     661.27330   -0.05730    0.00857    0.01473   0.27285   0.23980   0.36325   0.23843   0.36235
    3.90000   -3.60313   1.69261   -0.11312   -3.10913   0.27943   12.66354   0.11575   0.28678   0.46035   -0.64829   -0.50365     659.01910   -0.05766    0.00871    0.01476   0.27228   0.24013   0.36305   0.23874   0.36213
    3.95000   -3.59498   1.69040   -0.11297   -3.11561   0.28092   12.70325   0.11397   0.28446   0.45713   -0.64594   -0.49916     655.26563   -0.05792    0.00898    0.01464   0.27183   0.24044   0.36290   0.23903   0.36197
    4.00000   -3.58792   1.68909   -0.11288   -3.12247   0.28228   12.75432   0.11199   0.28174   0.45344   -0.64282   -0.49398     651.48506   -0.05830    0.00927    0.01454   0.27131   0.24073   0.36271   0.23930   0.36176
    4.05000   -3.57639   1.68687   -0.11271   -3.12842   0.28337   12.83276   0.10938   0.27822   0.44875   -0.63876   -0.48687     646.55144   -0.05897    0.00954    0.01459   0.27080   0.24102   0.36253   0.23955   0.36155
    4.10000   -3.55612   1.68126   -0.11220   -3.13309   0.28421   12.90768   0.10684   0.27446   0.44431   -0.63412   -0.47920     641.77419   -0.05973    0.00936    0.01507   0.27015   0.24120   0.36216   0.23970   0.36116
    4.15000   -3.52734   1.67174   -0.11128   -3.13478   0.28453   12.98967   0.10474   0.27085   0.44063   -0.62937   -0.47159     637.47538   -0.06001    0.00879    0.01573   0.26941   0.24151   0.36181   0.24000   0.36081
    4.20000   -3.49975   1.66129   -0.11022   -3.13306   0.28445   13.04693   0.10219   0.26704   0.43640   -0.62478   -0.46322     632.18054   -0.06030    0.00825    0.01635   0.26875   0.24186   0.36156   0.24035   0.36055
    4.25000   -3.47625   1.65178   -0.10920   -3.12958   0.28411   13.09465   0.09869   0.26243   0.43105   -0.61979   -0.45329     625.49569   -0.06104    0.00800    0.01689   0.26820   0.24201   0.36125   0.24047   0.36022
    4.30000   -3.45023   1.64172   -0.10814   -3.12659   0.28371   13.17742   0.09633   0.25927   0.42668   -0.61549   -0.44614     621.12064   -0.06156    0.00765    0.01742   0.26774   0.24200   0.36091   0.24044   0.35986
    4.35000   -3.42876   1.63314   -0.10724   -3.12457   0.28352   13.25349   0.09526   0.25737   0.42366   -0.61168   -0.44165     619.19388   -0.06201    0.00718    0.01803   0.26749   0.24180   0.36058   0.24022   0.35952
    4.40000   -3.40994   1.62543   -0.10645   -3.12298   0.28350   13.32518   0.09468   0.25627   0.42110   -0.60856   -0.43837     618.56422   -0.06227    0.00667    0.01859   0.26733   0.24162   0.36034   0.24003   0.35928
    4.45000   -3.40251   1.62151   -0.10599   -3.12171   0.28360   13.39387   0.09419   0.25529   0.41902   -0.60601   -0.43545     617.91658   -0.06276    0.00643    0.01901   0.26715   0.24176   0.36030   0.24016   0.35923
    4.50000   -3.38958   1.61689   -0.10553   -3.12265   0.28397   13.48038   0.09335   0.25390   0.41692   -0.60397   -0.43234     616.41549   -0.06345    0.00629    0.01942   0.26693   0.24170   0.36010   0.24006   0.35900
    4.55000   -3.37764   1.61338   -0.10521   -3.12559   0.28458   13.56710   0.09314   0.25291   0.41488   -0.60105   -0.42994     616.35231   -0.06356    0.00603    0.01970   0.26676   0.24178   0.36003   0.24014   0.35893
    4.60000   -3.35837   1.60831   -0.10480   -3.13006   0.28531   13.67368   0.09337   0.25211   0.41312   -0.59780   -0.42841     617.34143   -0.06369    0.00583    0.01994   0.26671   0.24182   0.36002   0.24017   0.35891
    4.65000   -3.33537   1.60205   -0.10426   -3.13400   0.28585   13.79023   0.09334   0.25090   0.41144   -0.59465   -0.42666     617.87888   -0.06418    0.00564    0.02030   0.26668   0.24168   0.35990   0.24001   0.35878
    4.70000   -3.31365   1.59499   -0.10361   -3.13584   0.28622   13.89582   0.09352   0.24995   0.40986   -0.59126   -0.42482     618.96355   -0.06455    0.00520    0.02084   0.26660   0.24160   0.35979   0.23991   0.35866
    4.75000   -3.30404   1.59030   -0.10309   -3.13427   0.28621   13.96089   0.09406   0.24927   0.40858   -0.58771   -0.42351     620.79136   -0.06471    0.00468    0.02138   0.26649   0.24160   0.35970   0.23991   0.35857
    4.80000   -3.29858   1.58617   -0.10261   -3.13091   0.28606   14.00011   0.09466   0.24884   0.40746   -0.58437   -0.42265     622.86053   -0.06453    0.00409    0.02185   0.26629   0.24166   0.35959   0.23998   0.35847
    4.85000   -3.29125   1.58239   -0.10220   -3.12908   0.28608   14.05150   0.09427   0.24761   0.40520   -0.58119   -0.42036     623.13747   -0.06490    0.00377    0.02230   0.26605   0.24170   0.35944   0.24000   0.35831
    4.90000   -3.27782   1.57682   -0.10170   -3.12959   0.28663   14.09145   0.09402   0.24672   0.40323   -0.57816   -0.41829     623.63760   -0.06500    0.00331    0.02277   0.26576   0.24178   0.35928   0.24009   0.35815
    4.95000   -3.26233   1.57143   -0.10127   -3.13211   0.28742   14.14737   0.09413   0.24636   0.40181   -0.57545   -0.41723     625.21144   -0.06506    0.00282    0.02324   0.26552   0.24173   0.35907   0.24003   0.35794
    5.00000   -3.24400   1.56533   -0.10079   -3.13552   0.28824   14.20965   0.09482   0.24643   0.40111   -0.57286   -0.41746     628.30418   -0.06512    0.00232    0.02373   0.26529   0.24160   0.35882   0.23991   0.35768
    5.05000   -3.22827   1.55960   -0.10030   -3.13785   0.28887   14.26194   0.09566   0.24676   0.40085   -0.57095   -0.41844     631.51724   -0.06553    0.00180    0.02435   0.26508   0.24137   0.35851   0.23966   0.35735
    5.10000   -3.22439   1.55649   -0.10000   -3.13738   0.28930   14.28287   0.09600   0.24662   0.39985   -0.56892   -0.41839     633.72473   -0.06624    0.00150    0.02491   0.26485   0.24116   0.35820   0.23941   0.35702
    5.15000   -3.21975   1.55387   -0.09980   -3.13940   0.29022   14.29155   0.09582   0.24580   0.39857   -0.56714   -0.41728     634.62404   -0.06710    0.00126    0.02546   0.26465   0.24099   0.35793   0.23919   0.35672
    5.20000   -3.21329   1.55163   -0.09966   -3.14270   0.29120   14.32880   0.09500   0.24442   0.39691   -0.56594   -0.41517     633.56057   -0.06796    0.00106    0.02598   0.26449   0.24076   0.35766   0.23892   0.35642
    5.25000   -3.21060   1.54936   -0.09941   -3.14217   0.29155   14.35743   0.09429   0.24328   0.39548   -0.56489   -0.41321     632.58995   -0.06850    0.00078    0.02645   0.26425   0.24053   0.35733   0.23865   0.35607
    5.30000   -3.21169   1.54826   -0.09923   -3.14054   0.29161   14.39293   0.09337   0.24199   0.39368   -0.56353   -0.41101     631.51361   -0.06897    0.00058    0.02681   0.26405   0.24026   0.35700   0.23836   0.35572
    5.35000   -3.20797   1.54483   -0.09880   -3.13778   0.29154   14.41551   0.09227   0.24034   0.39150   -0.56191   -0.40842     630.09308   -0.06945    0.00039    0.02718   0.26382   0.24002   0.35667   0.23809   0.35537
    5.40000   -3.20537   1.54153   -0.09838   -3.13459   0.29141   14.43390   0.09114   0.23898   0.38910   -0.56068   -0.40609     629.00140   -0.06962    0.00012    0.02748   0.26358   0.23966   0.35624   0.23772   0.35494
    5.45000   -3.20295   1.53878   -0.09802   -3.13229   0.29133   14.45675   0.09028   0.23779   0.38697   -0.55936   -0.40429     628.33068   -0.06949   -0.00015    0.02768   0.26322   0.23924   0.35570   0.23731   0.35440
    5.50000   -3.19896   1.53475   -0.09754   -3.12834   0.29109   14.45681   0.08936   0.23646   0.38517   -0.55839   -0.40235     627.07836   -0.06912   -0.00048    0.02783   0.26281   0.23893   0.35518   0.23701   0.35389
    5.55000   -3.19501   1.53082   -0.09706   -3.12423   0.29077   14.46352   0.08868   0.23555   0.38399   -0.55782   -0.40090     626.04641   -0.06815   -0.00096    0.02790   0.26247   0.23874   0.35481   0.23687   0.35355
    5.60000   -3.19009   1.52727   -0.09663   -3.12210   0.29064   14.48643   0.08842   0.23516   0.38313   -0.55736   -0.40024     625.87900   -0.06718   -0.00147    0.02798   0.26215   0.23853   0.35443   0.23671   0.35321
    5.65000   -3.18569   1.52367   -0.09615   -3.11904   0.29030   14.52126   0.08819   0.23451   0.38225   -0.55653   -0.39892     625.72287   -0.06634   -0.00215    0.02827   0.26178   0.23839   0.35406   0.23661   0.35286
    5.70000   -3.18588   1.52052   -0.09565   -3.11304   0.28958   14.54133   0.08748   0.23358   0.38103   -0.55607   -0.39651     624.17968   -0.06540   -0.00301    0.02868   0.26150   0.23832   0.35380   0.23659   0.35264
    5.75000   -3.18941   1.51809   -0.09516   -3.10499   0.28852   14.55922   0.08644   0.23243   0.37941   -0.55565   -0.39335     621.86286   -0.06441   -0.00376    0.02898   0.26124   0.23826   0.35358   0.23658   0.35245
    5.80000   -3.18906   1.51435   -0.09461   -3.09747   0.28768   14.56508   0.08565   0.23134   0.37773   -0.55469   -0.39035     620.31159   -0.06312   -0.00450    0.02915   0.26093   0.23826   0.35335   0.23664   0.35225
    5.85000   -3.19425   1.51214   -0.09417   -3.08848   0.28661   14.56773   0.08490   0.23007   0.37614   -0.55345   -0.38714     618.83601   -0.06202   -0.00513    0.02929   0.26057   0.23832   0.35312   0.23675   0.35206
    5.90000   -3.20374   1.51111   -0.09381   -3.07883   0.28546   14.55397   0.08391   0.22841   0.37465   -0.55218   -0.38356     616.98071   -0.06103   -0.00570    0.02942   0.26019   0.23836   0.35287   0.23683   0.35184
    5.95000   -3.21744   1.51116   -0.09351   -3.06789   0.28409   14.55107   0.08321   0.22712   0.37347   -0.55091   -0.38066     615.85224   -0.05980   -0.00629    0.02947   0.25985   0.23847   0.35269   0.23699   0.35169
    6.00000   -3.24192   1.51451   -0.09349   -3.05603   0.28263   14.54023   0.08224   0.22569   0.37213   -0.54985   -0.37726     614.01945   -0.05880   -0.00695    0.02968   0.25952   0.23859   0.35253   0.23716   0.35156
    6.05000   -3.26560   1.51749   -0.09346   -3.04447   0.28135   14.50699   0.08113   0.22402   0.37052   -0.54829   -0.37332     612.02342   -0.05756   -0.00773    0.02991   0.25919   0.23872   0.35237   0.23733   0.35144
    6.10000   -3.28857   1.52000   -0.09340   -3.03280   0.28012   14.46278   0.08049   0.22286   0.36934   -0.54684   -0.37039     611.17171   -0.05622   -0.00855    0.03013   0.25876   0.23895   0.35221   0.23761   0.35131
    6.15000   -3.30973   1.52264   -0.09340   -3.02282   0.27908   14.42994   0.08005   0.22189   0.36830   -0.54510   -0.36792     610.98538   -0.05497   -0.00931    0.03034   0.25831   0.23919   0.35205   0.23790   0.35117
    6.20000   -3.32993   1.52506   -0.09341   -3.01359   0.27820   14.38798   0.07965   0.22095   0.36707   -0.54321   -0.36564     610.81209   -0.05392   -0.01002    0.03057   0.25789   0.23947   0.35193   0.23821   0.35107
    6.25000   -3.34676   1.52702   -0.09341   -3.00610   0.27753   14.35898   0.07929   0.22007   0.36582   -0.54133   -0.36352     610.82703   -0.05301   -0.01074    0.03086   0.25749   0.23975   0.35182   0.23851   0.35099
    6.30000   -3.36329   1.52902   -0.09345   -2.99973   0.27709   14.32124   0.07920   0.21951   0.36464   -0.53928   -0.36184     611.78360   -0.05223   -0.01153    0.03127   0.25712   0.24001   0.35173   0.23879   0.35090
    6.35000   -3.38079   1.53168   -0.09353   -2.99422   0.27671   14.29255   0.07911   0.21898   0.36331   -0.53725   -0.36006     612.64429   -0.05159   -0.01231    0.03173   0.25678   0.24029   0.35168   0.23909   0.35086
    6.40000   -3.39983   1.53521   -0.09370   -2.98898   0.27629   14.27435   0.07899   0.21825   0.36158   -0.53452   -0.35786     613.55575   -0.05111   -0.01305    0.03220   0.25649   0.24057   0.35165   0.23937   0.35083
    6.45000   -3.41858   1.53795   -0.09378   -2.98231   0.27575   14.24012   0.07895   0.21757   0.36007   -0.53183   -0.35571     614.85439   -0.05055   -0.01377    0.03264   0.25626   0.24083   0.35167   0.23964   0.35085
    6.50000   -3.43860   1.54042   -0.09381   -2.97478   0.27517   14.17735   0.07896   0.21686   0.35892   -0.52924   -0.35374     616.36384   -0.05013   -0.01447    0.03310   0.25601   0.24116   0.35171   0.23997   0.35090
    6.55000   -3.45574   1.54230   -0.09385   -2.96916   0.27491   14.10650   0.07950   0.21654   0.35837   -0.52672   -0.35265     618.89548   -0.04960   -0.01523    0.03358   0.25575   0.24149   0.35175   0.24029   0.35093
    6.60000   -3.46943   1.54365   -0.09391   -2.96570   0.27503   14.03234   0.08012   0.21628   0.35801   -0.52439   -0.35158     621.27509   -0.04886   -0.01604    0.03402   0.25546   0.24190   0.35182   0.24072   0.35100
    6.65000   -3.48243   1.54461   -0.09393   -2.96167   0.27510   13.95189   0.08061   0.21610   0.35736   -0.52235   -0.35050     623.32922   -0.04793   -0.01689    0.03442   0.25517   0.24231   0.35189   0.24114   0.35108
    6.70000   -3.49595   1.54598   -0.09400   -2.95782   0.27519   13.87486   0.08050   0.21545   0.35627   -0.52078   -0.34871     623.73353   -0.04731   -0.01762    0.03483   0.25487   0.24271   0.35195   0.24155   0.35115
    6.75000   -3.51018   1.54771   -0.09408   -2.95361   0.27517   13.80520   0.08007   0.21465   0.35509   -0.51946   -0.34666     623.49453   -0.04679   -0.01827    0.03521   0.25460   0.24310   0.35202   0.24193   0.35122
    6.80000   -3.52575   1.54997   -0.09421   -2.94928   0.27512   13.73739   0.07946   0.21369   0.35380   -0.51817   -0.34444     623.02510   -0.04648   -0.01883    0.03559   0.25432   0.24341   0.35204   0.24224   0.35123
    6.85000   -3.53897   1.55162   -0.09430   -2.94583   0.27519   13.67606   0.07901   0.21290   0.35281   -0.51672   -0.34261     623.08139   -0.04634   -0.01937    0.03602   0.25402   0.24370   0.35201   0.24251   0.35120
    6.90000   -3.55069   1.55266   -0.09433   -2.94212   0.27522   13.60932   0.07866   0.21218   0.35189   -0.51532   -0.34096     623.26769   -0.04600   -0.01998    0.03643   0.25379   0.24396   0.35203   0.24277   0.35120
    6.95000   -3.55831   1.55260   -0.09429   -2.93899   0.27535   13.54281   0.07794   0.21109   0.35068   -0.51392   -0.33876     622.56098   -0.04574   -0.02052    0.03682   0.25362   0.24417   0.35206   0.24298   0.35123
    7.00000   -3.56809   1.55301   -0.09430   -2.93598   0.27558   13.45438   0.07719   0.21004   0.34956   -0.51271   -0.33670     621.80126   -0.04549   -0.02101    0.03715   0.25347   0.24433   0.35206   0.24313   0.35122
    7.05000   -3.57766   1.55338   -0.09431   -2.93294   0.27577   13.37088   0.07667   0.20926   0.34879   -0.51181   -0.33528     621.40619   -0.04528   -0.02145    0.03747   0.25333   0.24443   0.35203   0.24321   0.35118
    7.10000   -3.58708   1.55349   -0.09429   -2.92957   0.27592   13.28415   0.07629   0.20878   0.34820   -0.51112   -0.33424     621.37176   -0.04492   -0.02195    0.03777   0.25313   0.24450   0.35193   0.24328   0.35108
    7.15000   -3.59667   1.55373   -0.09428   -2.92607   0.27604   13.20200   0.07589   0.20843   0.34750   -0.51054   -0.33332     621.37831   -0.04428   -0.02252    0.03803   0.25288   0.24460   0.35182   0.24338   0.35097
    7.20000   -3.60615   1.55373   -0.09426   -2.92216   0.27613   13.11767   0.07580   0.20844   0.34686   -0.50984   -0.33288     622.16965   -0.04338   -0.02315    0.03823   0.25258   0.24474   0.35170   0.24353   0.35086
    7.25000   -3.61723   1.55394   -0.09424   -2.91732   0.27609   13.02800   0.07594   0.20872   0.34641   -0.50914   -0.33279     623.35415   -0.04259   -0.02383    0.03853   0.25226   0.24481   0.35152   0.24360   0.35068
    7.30000   -3.62487   1.55359   -0.09418   -2.91318   0.27604   12.95324   0.07590   0.20884   0.34572   -0.50825   -0.33238     624.32210   -0.04205   -0.02449    0.03889   0.25197   0.24481   0.35132   0.24359   0.35047
    7.35000   -3.62817   1.55233   -0.09406   -2.91027   0.27611   12.88774   0.07584   0.20896   0.34510   -0.50744   -0.33205     625.18334   -0.04161   -0.02508    0.03925   0.25171   0.24475   0.35109   0.24352   0.35023
    7.40000   -3.63197   1.55119   -0.09396   -2.90734   0.27618   12.81727   0.07601   0.20924   0.34482   -0.50674   -0.33212     626.37969   -0.04122   -0.02572    0.03966   0.25140   0.24469   0.35082   0.24344   0.34995
    7.45000   -3.63613   1.54988   -0.09384   -2.90420   0.27626   12.74165   0.07645   0.20970   0.34489   -0.50626   -0.33270     627.90131   -0.04074   -0.02637    0.04005   0.25102   0.24463   0.35051   0.24337   0.34963
    7.50000   -3.64131   1.54912   -0.09376   -2.90122   0.27631   12.67079   0.07679   0.21008   0.34476   -0.50571   -0.33308     629.53021   -0.04038   -0.02698    0.04045   0.25063   0.24464   0.35024   0.24336   0.34934
    7.55000   -3.64293   1.54723   -0.09360   -2.89904   0.27651   12.59374   0.07723   0.21055   0.34469   -0.50500   -0.33359     631.58148   -0.04009   -0.02758    0.04086   0.25024   0.24464   0.34996   0.24334   0.34905
    7.60000   -3.64158   1.54447   -0.09340   -2.89763   0.27688   12.51041   0.07768   0.21109   0.34478   -0.50465   -0.33426     633.33745   -0.03970   -0.02818    0.04125   0.24986   0.24465   0.34969   0.24334   0.34877
    7.65000   -3.64199   1.54204   -0.09320   -2.89544   0.27711   12.42342   0.07805   0.21153   0.34501   -0.50463   -0.33498     634.62256   -0.03936   -0.02874    0.04161   0.24949   0.24465   0.34942   0.24332   0.34849
    7.70000   -3.64223   1.53959   -0.09299   -2.89299   0.27726   12.33712   0.07819   0.21173   0.34499   -0.50456   -0.33534     635.33264   -0.03904   -0.02925    0.04193   0.24908   0.24462   0.34912   0.24328   0.34818
    7.75000   -3.64390   1.53761   -0.09281   -2.89039   0.27737   12.25380   0.07803   0.21171   0.34495   -0.50475   -0.33529     635.24475   -0.03879   -0.02968    0.04222   0.24865   0.24463   0.34882   0.24327   0.34786
    7.80000   -3.64818   1.53609   -0.09265   -2.88687   0.27741   12.15977   0.07772   0.21150   0.34467   -0.50470   -0.33490     634.98650   -0.03860   -0.03004    0.04246   0.24822   0.24464   0.34851   0.24326   0.34754
    7.85000   -3.65578   1.53539   -0.09254   -2.88214   0.27725   12.06494   0.07751   0.21139   0.34453   -0.50475   -0.33468     634.91282   -0.03857   -0.03042    0.04278   0.24779   0.24463   0.34820   0.24323   0.34722
    7.90000   -3.66320   1.53473   -0.09244   -2.87764   0.27714   11.97055   0.07741   0.21138   0.34436   -0.50455   -0.33457     635.21525   -0.03847   -0.03081    0.04309   0.24737   0.24464   0.34791   0.24323   0.34692
    7.95000   -3.66987   1.53350   -0.09228   -2.87251   0.27693   11.87446   0.07754   0.21148   0.34447   -0.50428   -0.33471     635.87781   -0.03822   -0.03125    0.04338   0.24698   0.24466   0.34765   0.24323   0.34665
    8.00000   -3.67741   1.53248   -0.09214   -2.86723   0.27672   11.77290   0.07758   0.21140   0.34451   -0.50382   -0.33465     636.38112   -0.03798   -0.03165    0.04364   0.24660   0.24466   0.34738   0.24322   0.34636
    8.05000   -3.68556   1.53196   -0.09205   -2.86265   0.27659   11.67567   0.07770   0.21125   0.34467   -0.50334   -0.33459     636.88334   -0.03770   -0.03200    0.04383   0.24623   0.24471   0.34715   0.24326   0.34613
    8.10000   -3.69273   1.53131   -0.09196   -2.85842   0.27648   11.58296   0.07780   0.21107   0.34483   -0.50287   -0.33446     637.52578   -0.03727   -0.03239    0.04400   0.24587   0.24478   0.34695   0.24332   0.34592
    8.15000   -3.70027   1.53113   -0.09191   -2.85483   0.27643   11.50093   0.07796   0.21110   0.34493   -0.50255   -0.33458     638.24185   -0.03678   -0.03283    0.04419   0.24549   0.24488   0.34674   0.24341   0.34570
    8.20000   -3.70910   1.53127   -0.09189   -2.85085   0.27632   11.41484   0.07798   0.21094   0.34482   -0.50215   -0.33437     638.56300   -0.03637   -0.03326    0.04441   0.24515   0.24497   0.34657   0.24349   0.34552
    8.25000   -3.71405   1.53053   -0.09182   -2.84807   0.27640   11.33431   0.07801   0.21074   0.34457   -0.50150   -0.33408     638.90350   -0.03609   -0.03365    0.04465   0.24482   0.24500   0.34636   0.24351   0.34530
    8.30000   -3.71401   1.52859   -0.09168   -2.84678   0.27669   11.25740   0.07820   0.21073   0.34446   -0.50087   -0.33416     639.62908   -0.03582   -0.03403    0.04487   0.24452   0.24499   0.34613   0.24348   0.34506
    8.35000   -3.71147   1.52564   -0.09145   -2.84506   0.27692   11.17477   0.07836   0.21069   0.34446   -0.50042   -0.33420     640.08567   -0.03561   -0.03439    0.04511   0.24421   0.24493   0.34588   0.24341   0.34480
    8.40000   -3.70828   1.52251   -0.09120   -2.84327   0.27711   11.09458   0.07843   0.21048   0.34428   -0.49973   -0.33403     640.43031   -0.03557   -0.03470    0.04536   0.24390   0.24486   0.34561   0.24331   0.34451
    8.45000   -3.70492   1.51949   -0.09095   -2.84177   0.27730   11.01618   0.07848   0.21020   0.34408   -0.49888   -0.33389     640.77957   -0.03566   -0.03493    0.04560   0.24360   0.24476   0.34532   0.24320   0.34422
    8.50000   -3.70101   1.51653   -0.09073   -2.84084   0.27756   10.94108   0.07865   0.20995   0.34404   -0.49807   -0.33388     641.23273   -0.03587   -0.03516    0.04589   0.24329   0.24469   0.34506   0.24311   0.34394
    8.55000   -3.69655   1.51361   -0.09051   -2.84020   0.27780   10.87704   0.07886   0.20977   0.34414   -0.49738   -0.33404     641.76200   -0.03614   -0.03536    0.04618   0.24299   0.24462   0.34480   0.24302   0.34366
    8.60000   -3.69331   1.51124   -0.09033   -2.83955   0.27801   10.81736   0.07897   0.20960   0.34437   -0.49702   -0.33421     641.99995   -0.03642   -0.03556    0.04646   0.24273   0.24454   0.34456   0.24292   0.34341
    8.65000   -3.68964   1.50873   -0.09014   -2.83855   0.27814   10.76133   0.07907   0.20941   0.34454   -0.49655   -0.33433     642.24736   -0.03673   -0.03574    0.04675   0.24248   0.24445   0.34431   0.24281   0.34315
    8.70000   -3.68494   1.50615   -0.08995   -2.83809   0.27834   10.70580   0.07892   0.20902   0.34451   -0.49603   -0.33411     641.93651   -0.03702   -0.03590    0.04702   0.24222   0.24438   0.34408   0.24272   0.34291
    8.75000   -3.67902   1.50331   -0.08975   -2.83792   0.27857   10.65300   0.07885   0.20869   0.34442   -0.49539   -0.33402     641.82451   -0.03730   -0.03607    0.04727   0.24196   0.24432   0.34385   0.24264   0.34266
    8.80000   -3.67386   1.50058   -0.08954   -2.83708   0.27867   10.60343   0.07875   0.20846   0.34432   -0.49491   -0.33401     641.59434   -0.03765   -0.03618    0.04751   0.24164   0.24424   0.34357   0.24254   0.34237
    8.85000   -3.67023   1.49842   -0.08938   -2.83633   0.27880   10.55335   0.07854   0.20813   0.34412   -0.49449   -0.33375     641.11623   -0.03794   -0.03626    0.04770   0.24130   0.24416   0.34328   0.24246   0.34207
    8.90000   -3.66639   1.49625   -0.08922   -2.83540   0.27888   10.50440   0.07824   0.20767   0.34379   -0.49402   -0.33324     640.31599   -0.03816   -0.03637    0.04788   0.24100   0.24411   0.34303   0.24239   0.34181
    8.95000   -3.66133   1.49363   -0.08903   -2.83464   0.27903   10.44595   0.07786   0.20706   0.34338   -0.49344   -0.33253     639.20049   -0.03832   -0.03648    0.04805   0.24070   0.24406   0.34279   0.24232   0.34155
    9.00000   -3.65766   1.49139   -0.08887   -2.83353   0.27910   10.39062   0.07765   0.20655   0.34298   -0.49260   -0.33204     638.62628   -0.03838   -0.03659    0.04817   0.24039   0.24402   0.34254   0.24228   0.34130
    9.05000   -3.65239   1.48867   -0.08867   -2.83290   0.27926   10.33533   0.07756   0.20615   0.34258   -0.49170   -0.33165     638.33321   -0.03836   -0.03671    0.04827   0.24006   0.24396   0.34227   0.24222   0.34102
    9.10000   -3.64690   1.48576   -0.08845   -2.83195   0.27939   10.27836   0.07752   0.20579   0.34214   -0.49072   -0.33125     638.20891   -0.03833   -0.03686    0.04839   0.23970   0.24391   0.34198   0.24216   0.34073
    9.15000   -3.64157   1.48325   -0.08828   -2.83170   0.27957   10.22930   0.07741   0.20543   0.34149   -0.48955   -0.33074     638.13166   -0.03833   -0.03694    0.04845   0.23939   0.24388   0.34174   0.24212   0.34049
    9.20000   -3.63586   1.48065   -0.08810   -2.83136   0.27971   10.18312   0.07743   0.20518   0.34093   -0.48833   -0.33038     638.30542   -0.03828   -0.03706    0.04855   0.23912   0.24385   0.34153   0.24208   0.34027
    9.25000   -3.63066   1.47830   -0.08793   -2.83108   0.27983   10.13866   0.07756   0.20500   0.34052   -0.48721   -0.33025     638.63157   -0.03811   -0.03720    0.04860   0.23887   0.24381   0.34133   0.24204   0.34007
    9.30000   -3.62851   1.47677   -0.08782   -2.83022   0.27987   10.08957   0.07764   0.20483   0.34007   -0.48621   -0.33014     638.74158   -0.03787   -0.03733    0.04861   0.23864   0.24377   0.34113   0.24200   0.33987
    9.35000   -3.62562   1.47518   -0.08772   -2.82982   0.27997   10.04380   0.07782   0.20473   0.33973   -0.48524   -0.33024     639.15016   -0.03747   -0.03745    0.04856   0.23841   0.24372   0.34093   0.24195   0.33967
    9.40000   -3.62436   1.47400   -0.08764   -2.82879   0.27996    9.99974   0.07797   0.20466   0.33943   -0.48455   -0.33038     639.36804   -0.03696   -0.03759    0.04847   0.23819   0.24367   0.34074   0.24190   0.33949
    9.45000   -3.62523   1.47346   -0.08760   -2.82729   0.27987    9.95685   0.07797   0.20450   0.33896   -0.48393   -0.33030     639.26908   -0.03646   -0.03770    0.04837   0.23798   0.24363   0.34058   0.24188   0.33932
    9.50000   -3.62919   1.47408   -0.08765   -2.82573   0.27972    9.91763   0.07786   0.20425   0.33836   -0.48331   -0.32993     638.93940   -0.03601   -0.03783    0.04829   0.23779   0.24364   0.34045   0.24188   0.33920
    9.55000   -3.63372   1.47473   -0.08770   -2.82383   0.27952    9.87629   0.07789   0.20402   0.33789   -0.48264   -0.32973     638.83798   -0.03559   -0.03794    0.04822   0.23758   0.24366   0.34032   0.24192   0.33907
    9.60000   -3.63729   1.47500   -0.08772   -2.82203   0.27935    9.83293   0.07803   0.20384   0.33754   -0.48202   -0.32968     638.98631   -0.03515   -0.03806    0.04814   0.23739   0.24366   0.34018   0.24191   0.33894
    9.65000   -3.63679   1.47426   -0.08767   -2.82143   0.27937    9.79248   0.07821   0.20378   0.33724   -0.48149   -0.32979     639.36121   -0.03464   -0.03819    0.04805   0.23718   0.24362   0.34001   0.24188   0.33876
    9.70000   -3.63345   1.47266   -0.08757   -2.82157   0.27952    9.75051   0.07849   0.20378   0.33700   -0.48088   -0.33007     640.04153   -0.03415   -0.03830    0.04795   0.23696   0.24350   0.33977   0.24177   0.33853
    9.75000   -3.62789   1.47059   -0.08746   -2.82268   0.27984    9.70906   0.07876   0.20376   0.33670   -0.48023   -0.33036     640.73373   -0.03376   -0.03838    0.04786   0.23673   0.24339   0.33953   0.24166   0.33829
    9.80000   -3.62191   1.46839   -0.08733   -2.82392   0.28019    9.66572   0.07905   0.20371   0.33648   -0.47960   -0.33062     641.29444   -0.03324   -0.03848    0.04774   0.23650   0.24333   0.33933   0.24161   0.33809
    9.85000   -3.61411   1.46573   -0.08718   -2.82568   0.28061    9.62628   0.07941   0.20373   0.33625   -0.47891   -0.33088     641.97901   -0.03269   -0.03864    0.04765   0.23631   0.24329   0.33916   0.24157   0.33793
    9.90000   -3.60461   1.46255   -0.08699   -2.82759   0.28106    9.58888   0.07984   0.20387   0.33617   -0.47839   -0.33134     642.78018   -0.03200   -0.03883    0.04754   0.23614   0.24324   0.33901   0.24153   0.33779
    9.95000   -3.59478   1.45928   -0.08680   -2.82954   0.28152    9.55086   0.08024   0.20396   0.33610   -0.47787   -0.33174     643.69598   -0.03124   -0.03901    0.04739   0.23600   0.24319   0.33888   0.24148   0.33765
    10.0000   -3.58474   1.45589   -0.08659   -2.83142   0.28196    9.51260   0.08065   0.20402   0.33612   -0.47735   -0.33219     644.70999   -0.03045   -0.03919    0.04722   0.23589   0.24313   0.33876   0.24142   0.33754
    """)


class CauzziEtAl2014NoSOF(CauzziEtAl2014):
    """
    Returns the Cauzzi et al (GMPE) for the case when no style-of-faulting is
    input. This modifies both the expected ground motion as well as the
    inter-event (and thus total) standard deviations.
    """

    #: Required rupture parameters are magnitude
    REQUIRES_RUPTURE_PARAMETERS = set(('mag',))

    def _compute_mean(self, C, rup, dists, sites, imt):
        """
        Returns the mean ground motion acceleration and velocity
        """
        mean = (self._get_magnitude_scaling_term(C, rup.mag) +
                self._get_distance_scaling_term(C, rup.mag, dists.rrup) +
                self._get_site_amplification_term(C, sites.vs30))
        # convert from cm/s**2 to g for SA and from m/s**2 to g for PGA (PGV
        # is already in cm/s) and also convert from base 10 to base e.
        if isinstance(imt, PGA):
            mean = np.log((10 ** mean) * ((2 * np.pi / 0.01) ** 2) *
                          1e-2 / g)
        elif isinstance(imt, SA):
            mean = np.log((10 ** mean) * ((2 * np.pi / imt.period) ** 2) *
                          1e-2 / g)
        else:
            mean = np.log(10 ** mean)

        return mean

    def _get_stddevs(self, C, stddev_types, num_sites):
        """
        Returns the standard deviation terms assuming no style-of-faulting
        is known
        """
        stddevs = []
        for stddev_type in stddev_types:
            assert stddev_type in self.DEFINED_FOR_STANDARD_DEVIATION_TYPES
            if stddev_type == const.StdDev.TOTAL:
                stddevs.append(np.log(10.0 ** C['s']) + np.zeros(num_sites))
            elif stddev_type == const.StdDev.INTRA_EVENT:
                stddevs.append(np.log(10.0 ** C['f']) + np.zeros(num_sites))
            elif stddev_type == const.StdDev.INTER_EVENT:
                stddevs.append(np.log(10.0 ** C["t"]) + np.zeros(num_sites))
        return stddevs


class CauzziEtAl2014FixedVs30(CauzziEtAl2014):
    """
    Implements the Cauzzi et al (2014) model for the case in which
    the reference Vs30 in the site amplification term is fixed at 800 m/s
    """

    def _get_site_amplification_term(self, C, vs30):
        """
        Returns the site amplification scaling term assuming
        period dependent reference vs30
        """
        return C["bV800"] * np.log10(vs30 / 800.)


class CauzziEtAl2014FixedVs30NoSOF(CauzziEtAl2014NoSOF):
    """
    Implements the Cauzzi et al (2014) model for the case in which
    the reference Vs30 in the site amplification term is fixed at 800 m/s
    """

    def _get_site_amplification_term(self, C, vs30):
        """
        Returns the site amplification scaling term assuming the reference
        Vs30 is fixed at 800 m/s
        """
        return C["bV800"] * np.log10(vs30 / 800.)


class CauzziEtAl2014Eurocode8(CauzziEtAl2014):
    """
    Implmements the Cauzzi et al. (2014) GMPE for the case in which
    the Eurocode 8 site classification is preferred
    """
    def _get_site_amplification_term(self, C, vs30):
        """
        Returns the site amplification term on the basis of Eurocode 8
        site class
        """
        s_b, s_c, s_d = self._get_site_dummy_variables(vs30)
        return (C["sB"] * s_b) + (C["sC"] * s_c) + (C["sD"] * s_d)

    def _get_site_dummy_variables(self, vs30):
        """
        Returns the Eurocode 8 site class dummy variable
        """
        s_b = np.zeros_like(vs30)
        s_c = np.zeros_like(vs30)
        s_d = np.zeros_like(vs30)
        s_b[np.logical_and(vs30 >= 360., vs30 < 800.)] = 1.0
        s_c[np.logical_and(vs30 >= 180., vs30 < 360.)] = 1.0
        s_d[vs30 < 180] = 1.0
        return s_b, s_c, s_d


class CauzziEtAl2014Eurocode8NoSOF(CauzziEtAl2014NoSOF):
    """
    Implmements the Cauzzi et al. (2014) GMPE for the case in which
    the Eurocode 8 site classification is preferred and style of faulting
    is not specified.
    """
    def _get_site_amplification_term(self, C, vs30):
        """
        Returns the site amplification term on the basis of Eurocode 8
        site class
        """
        s_b, s_c, s_d = self._get_site_dummy_variables(vs30)
        return (C["sB"] * s_b) + (C["sC"] * s_c) + (C["sD"] * s_d)

    def _get_site_dummy_variables(self, vs30):
        """
        Returns the Eurocode 8 site class dummy variable
        """
        s_b = np.zeros_like(vs30)
        s_c = np.zeros_like(vs30)
        s_d = np.zeros_like(vs30)
        s_b[np.logical_and(vs30 >= 360., vs30 < 800.)] = 1.0
        s_c[np.logical_and(vs30 >= 180., vs30 < 360.)] = 1.0
        s_d[vs30 < 180.] = 1.0
        return s_b, s_c, s_d
