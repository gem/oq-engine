# Copyright (c) 2010-2014, GEM Foundation.
#
# OpenQuake is free software: you can redistribute it and/or modify it
# under the terms of the GNU Affero General Public License as published
# by the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# OpenQuake is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with OpenQuake.  If not, see <http://www.gnu.org/licenses/>.

import numpy

#: Shape of the result matrices (which are numpy arrays)
SHAPE = (3, 4, 2, 1, 3, 1)

RLZ_1_POE_002_PGA = numpy.array([[
    0.00000000e+00,   1.44929695e-05,   8.94313279e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   1.85282777e-03,   5.32911815e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   5.12899532e-06,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   1.44808425e-03,   1.83899533e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   2.07205301e-05,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00]]
).reshape(SHAPE)

RLZ_2_POE_002_PGA = numpy.array([[
    0.00000000e+00,   1.44929695e-05,   8.94313279e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   1.85282777e-03,   5.32911815e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   5.12899532e-06,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   1.44808425e-03,   1.83899533e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   2.07205301e-05,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00]]).reshape(SHAPE)

RLZ_1_POE_002_SA = numpy.array([[
    0.00000000e+00,   0.00000000e+00,   8.58909017e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   1.61042890e-03,   5.08786726e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   1.05438963e-06,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   1.32010828e-03,   1.76395442e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   1.80941665e-05,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00]]).reshape(SHAPE)

RLZ_2_POE_002_SA = numpy.array([[
    0.00000000e+00,   0.00000000e+00,   8.58909017e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   1.61042890e-03,   5.08786726e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   1.05438963e-06,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   1.32010828e-03,   1.76395442e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   1.80941665e-05,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00]]).reshape(SHAPE)

RLZ_1_POE_01_PGA = numpy.array([[
    0.00000000e+00,   1.08743399e-02,   4.51708532e-02,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   2.72494620e-04,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    2.95939499e-05,   1.40067509e-02,   1.43465036e-02,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   4.22018889e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   1.02528246e-05,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    1.62337693e-04,   5.95083638e-03,   3.50658809e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   6.06861991e-04,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   1.56593292e-04,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00]]).reshape(SHAPE)

RLZ_2_POE_01_PGA = numpy.array([[
    0.00000000e+00,   1.08743399e-02,   4.51708532e-02,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   2.72494620e-04,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    2.95939499e-05,   1.40067509e-02,   1.43465036e-02,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   4.22018889e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   1.02528246e-05,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    1.62337693e-04,   5.95083638e-03,   3.50658809e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   6.06861991e-04,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   1.56593292e-04,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00]]).reshape(SHAPE)

RLZ_1_POE_01_SA = numpy.array([[
    0.00000000e+00,   9.83526511e-03,   4.44079219e-02,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   2.42209842e-04,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    8.33151071e-06,   1.29710693e-02,   1.40006126e-02,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   3.83994689e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   7.20659830e-06,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    1.03630167e-04,   5.65090739e-03,   3.45979689e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   5.55237647e-04,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   1.39328823e-04,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00]]).reshape(SHAPE)

RLZ_2_POE_01_SA = numpy.array([[
    0.00000000e+00,   9.83526511e-03,   4.44079219e-02,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   2.42209842e-04,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    8.33151071e-06,   1.29710693e-02,   1.40006126e-02,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   3.83994689e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   7.20659830e-06,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    1.03630167e-04,   5.65090739e-03,   3.45979689e-03,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   5.55237647e-04,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   1.39328823e-04,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
    0.00000000e+00,   0.00000000e+00,   0.00000000e+00]]).reshape(SHAPE)

#: In this test case, we test the export of a single result.
#: This is the expected XML output.
EXPECTED_XML_DISAGG = """<?xml version='1.0' encoding='UTF-8'?>
<nrml xmlns:gml="http://www.opengis.net/gml" xmlns="http://openquake.org/xmlns/nrml/0.4">
  <disaggMatrices sourceModelTreePath="b1" gsimTreePath="b1" IMT="SA" investigationTime="50.0" saPeriod="0.025" saDamping="5.0" lon="10.1" lat="40.1" magBinEdges="5.0, 6.0, 7.0, 8.0" distBinEdges="0.0, 25.0, 50.0, 75.0, 100.0" lonBinEdges="9.0, 10.5, 12.0" latBinEdges="39.0, 40.5" epsBinEdges="-3.0, -1.0, 1.0, 3.0" tectonicRegionTypes="Active Shallow Crust">
    <disaggMatrix type="Mag" dims="3" poE="0.1" iml="0.327978093899">
      <prob index="0" value="0.0540356007077"/>
      <prob index="1" value="0.030542217132"/>
      <prob index="2" value="0.00988194542664"/>
    </disaggMatrix>
    <disaggMatrix type="Dist" dims="4" poE="0.1" iml="0.327978093899">
      <prob index="0" value="0.0876287280827"/>
      <prob index="1" value="0.00463419826064"/>
      <prob index="2" value="0.000146534417643"/>
      <prob index="3" value="0.0"/>
    </disaggMatrix>
    <disaggMatrix type="TRT" dims="1" poE="0.1" iml="0.327978093899">
      <prob index="0" value="0.0919899116736"/>
    </disaggMatrix>
    <disaggMatrix type="Mag,Dist" dims="3,4" poE="0.1" iml="0.327978093899">
      <prob index="0,0" value="0.0538064233108"/>
      <prob index="0,1" value="0.000242209842205"/>
      <prob index="0,2" value="0.0"/>
      <prob index="0,3" value="0.0"/>
      <prob index="1,0" value="0.0267981873101"/>
      <prob index="1,1" value="0.00383994689484"/>
      <prob index="1,2" value="7.20659830133e-06"/>
      <prob index="1,3" value="0.0"/>
      <prob index="2,0" value="0.00919384133929"/>
      <prob index="2,1" value="0.000555237647218"/>
      <prob index="2,2" value="0.000139328823429"/>
      <prob index="2,3" value="0.0"/>
    </disaggMatrix>
    <disaggMatrix type="Mag,Dist,Eps" dims="3,4,3" poE="0.1" iml="0.327978093899">
      <prob index="0,0,0" value="0.0"/>
      <prob index="0,0,1" value="0.0098352651069"/>
      <prob index="0,0,2" value="0.0444079218885"/>
      <prob index="0,1,0" value="0.0"/>
      <prob index="0,1,1" value="0.0"/>
      <prob index="0,1,2" value="0.000242209842205"/>
      <prob index="0,2,0" value="0.0"/>
      <prob index="0,2,1" value="0.0"/>
      <prob index="0,2,2" value="0.0"/>
      <prob index="0,3,0" value="0.0"/>
      <prob index="0,3,1" value="0.0"/>
      <prob index="0,3,2" value="0.0"/>
      <prob index="1,0,0" value="8.33151071333e-06"/>
      <prob index="1,0,1" value="0.0129710692721"/>
      <prob index="1,0,2" value="0.0140006126457"/>
      <prob index="1,1,0" value="0.0"/>
      <prob index="1,1,1" value="0.0"/>
      <prob index="1,1,2" value="0.00383994689484"/>
      <prob index="1,2,0" value="0.0"/>
      <prob index="1,2,1" value="0.0"/>
      <prob index="1,2,2" value="7.20659830133e-06"/>
      <prob index="1,3,0" value="0.0"/>
      <prob index="1,3,1" value="0.0"/>
      <prob index="1,3,2" value="0.0"/>
      <prob index="2,0,0" value="0.000103630166901"/>
      <prob index="2,0,1" value="0.00565090739146"/>
      <prob index="2,0,2" value="0.00345979689048"/>
      <prob index="2,1,0" value="0.0"/>
      <prob index="2,1,1" value="0.0"/>
      <prob index="2,1,2" value="0.000555237647218"/>
      <prob index="2,2,0" value="0.0"/>
      <prob index="2,2,1" value="0.0"/>
      <prob index="2,2,2" value="0.000139328823429"/>
      <prob index="2,3,0" value="0.0"/>
      <prob index="2,3,1" value="0.0"/>
      <prob index="2,3,2" value="0.0"/>
    </disaggMatrix>
    <disaggMatrix type="Lon,Lat" dims="2,1" poE="0.1" iml="0.327978093899">
      <prob index="0,0" value="0.0919899116736"/>
      <prob index="1,0" value="0.0"/>
    </disaggMatrix>
    <disaggMatrix type="Mag,Lon,Lat" dims="3,2,1" poE="0.1" iml="0.327978093899">
      <prob index="0,0,0" value="0.0540356007077"/>
      <prob index="0,1,0" value="0.0"/>
      <prob index="1,0,0" value="0.030542217132"/>
      <prob index="1,1,0" value="0.0"/>
      <prob index="2,0,0" value="0.00988194542664"/>
      <prob index="2,1,0" value="0.0"/>
    </disaggMatrix>
    <disaggMatrix type="Lon,Lat,TRT" dims="2,1,1" poE="0.1" iml="0.327978093899">
      <prob index="0,0,0" value="0.0919899116736"/>
      <prob index="1,0,0" value="0.0"/>
    </disaggMatrix>
  </disaggMatrices>
</nrml>
"""
