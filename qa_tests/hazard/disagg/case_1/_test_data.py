# Copyright (c) 2010-2012, GEM Foundation.
#
# OpenQuake is free software: you can redistribute it and/or modify it
# under the terms of the GNU Affero General Public License as published
# by the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# OpenQuake is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with OpenQuake.  If not, see <http://www.gnu.org/licenses/>.

import numpy

#: Shape of the result matrices (which are numpy arrays)
SHAPE = (3, 4, 2, 1, 3, 1)

RLZ_1_POE_002_PGA = numpy.array([
    0.016424855148375696,
    0.08513094269053034,
    0.019615877191987884,
    0.0,
    0.0,
    0.0,
    0.009439269676646786,
    0.29833986071446744,
    0.08830715208248933,
    0.0,
    0.0,
    0.0,
    0.0009069403999987528,
    0.17759461093723605,
    0.09424880438796367,
    0.0,
    0.0,
    0.0,
    0.0,
    0.01861446671038059,
    0.01757469061290576,
    0.0,
    0.0,
    0.0,
    0.002262608860064717,
    0.009819782733117073,
    0.0022626749576244794,
    0.0,
    0.0,
    0.0,
    0.010023774853364151,
    0.04857149429986888,
    0.011191846784559882,
    0.0,
    0.0,
    0.0,
    0.004480249730015486,
    0.041624319582612014,
    0.00977822557238968,
    0.0,
    0.0,
    0.0,
    1.0665817812249719e-05,
    0.018823134232843944,
    0.005625453281614025,
    0.0,
    0.0,
    0.0,
    0.0004071881626028521,
    0.0017671558501072022,
    0.0004071881626028519,
    0.0,
    0.0,
    0.0,
    0.00032288438695282276,
    0.0014034033405952587,
    0.0003233722863849393,
    0.0,
    0.0,
    0.0,
    0.000687201277633995,
    0.0032589726015510505,
    0.0007509326727000958,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0]).reshape(SHAPE)

RLZ_2_POE_002_PGA = numpy.array([
    0.016424855148375696,
    0.08513094269053034,
    0.019615877191987884,
    0.0,
    0.0,
    0.0,
    0.009439269676646786,
    0.29833986071446744,
    0.08830715208248933,
    0.0,
    0.0,
    0.0,
    0.0009069403999987528,
    0.17759461093723605,
    0.09424880438796367,
    0.0,
    0.0,
    0.0,
    0.0,
    0.01861446671038059,
    0.01757469061290576,
    0.0,
    0.0,
    0.0,
    0.002262608860064717,
    0.009819782733117073,
    0.0022626749576244794,
    0.0,
    0.0,
    0.0,
    0.010023774853364151,
    0.04857149429986888,
    0.011191846784559882,
    0.0,
    0.0,
    0.0,
    0.004480249730015486,
    0.041624319582612014,
    0.00977822557238968,
    0.0,
    0.0,
    0.0,
    1.0665817812249719e-05,
    0.018823134232843944,
    0.005625453281614025,
    0.0,
    0.0,
    0.0,
    0.0004071881626028521,
    0.0017671558501072022,
    0.0004071881626028519,
    0.0,
    0.0,
    0.0,
    0.00032288438695282276,
    0.0014034033405952587,
    0.0003233722863849393,
    0.0,
    0.0,
    0.0,
    0.000687201277633995,
    0.0032589726015510505,
    0.0007509326727000958,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0]).reshape(SHAPE)

RLZ_1_POE_002_SA = numpy.array([
    0.015912033211755657,
    0.07723840974369352,
    0.017797279251851473,
    0.0,
    0.0,
    0.0,
    0.012925024544641036,
    0.29608271735717345,
    0.08012015114927983,
    0.0,
    0.0,
    0.0,
    0.0018852142281371937,
    0.19906923374861485,
    0.09007270463276741,
    0.0,
    0.0,
    0.0,
    0.0,
    0.02458931457864734,
    0.022665631616277535,
    0.0,
    0.0,
    0.0,
    0.0020529012127717718,
    0.008909385687078875,
    0.0020529012127717713,
    0.0,
    0.0,
    0.0,
    0.009480602788132998,
    0.04406840638702406,
    0.010154244983247815,
    0.0,
    0.0,
    0.0,
    0.005156317194335251,
    0.03818986661554104,
    0.008871681311835257,
    0.0,
    0.0,
    0.0,
    0.00016964319564253687,
    0.018945581993782608,
    0.0051039146499154385,
    0.0,
    0.0,
    0.0,
    0.0003694375411797154,
    0.0016033219334563769,
    0.0003694375411797152,
    0.0,
    0.0,
    0.0,
    0.000293298940239957,
    0.0012732931039024253,
    0.0002933922774278555,
    0.0,
    0.0,
    0.0,
    0.0006465124486156326,
    0.0029568315959699935,
    0.0006813133231095853,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0]).reshape(SHAPE)

RLZ_2_POE_002_SA = numpy.array([
    0.015912033211755657,
    0.07723840974369352,
    0.017797279251851473,
    0.0,
    0.0,
    0.0,
    0.012925024544641036,
    0.29608271735717345,
    0.08012015114927983,
    0.0,
    0.0,
    0.0,
    0.0018852142281371937,
    0.19906923374861485,
    0.09007270463276741,
    0.0,
    0.0,
    0.0,
    0.0,
    0.02458931457864734,
    0.022665631616277535,
    0.0,
    0.0,
    0.0,
    0.0020529012127717718,
    0.008909385687078875,
    0.0020529012127717713,
    0.0,
    0.0,
    0.0,
    0.009480602788132998,
    0.04406840638702406,
    0.010154244983247815,
    0.0,
    0.0,
    0.0,
    0.005156317194335251,
    0.03818986661554104,
    0.008871681311835257,
    0.0,
    0.0,
    0.0,
    0.00016964319564253687,
    0.018945581993782608,
    0.0051039146499154385,
    0.0,
    0.0,
    0.0,
    0.0003694375411797154,
    0.0016033219334563769,
    0.0003694375411797152,
    0.0,
    0.0,
    0.0,
    0.000293298940239957,
    0.0012732931039024253,
    0.0002933922774278555,
    0.0,
    0.0,
    0.0,
    0.0006465124486156326,
    0.0029568315959699935,
    0.0006813133231095853,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0]).reshape(SHAPE)

RLZ_1_POE_01_PGA = numpy.array([
    0.015940763876383983,
    0.15064349710918093,
    0.03676150313684809,
    0.0,
    0.0,
    0.0,
    0.00025025563671227915,
    0.2464748975981903,
    0.15181968960451941,
    0.0,
    0.0,
    0.0,
    0.0,
    0.06947649307880735,
    0.07429586430477829,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0005699980293894011,
    0.0014514046802272472,
    0.0,
    0.0,
    0.0,
    0.004106884511235088,
    0.018402948296092337,
    0.004240408508794833,
    0.0,
    0.0,
    0.0,
    0.008314296398562454,
    0.08766594386217699,
    0.0209742907059884,
    0.0,
    0.0,
    0.0,
    0.0002675485020888638,
    0.05388591103069893,
    0.018325067318377894,
    0.0,
    0.0,
    0.0,
    0.0,
    0.009221542220687313,
    0.010542486396821142,
    0.0,
    0.0,
    0.0,
    0.0007627289041655591,
    0.0033117716170016427,
    0.0007630986251752323,
    0.0,
    0.0,
    0.0,
    0.0005443155673502398,
    0.002630074393442275,
    0.0006060219078637586,
    0.0,
    0.0,
    0.0,
    0.0005230493887186678,
    0.005819945308141101,
    0.0014072994815802443,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0]).reshape(SHAPE)

RLZ_2_POE_01_PGA = numpy.array([
    0.015940763876383983,
    0.15064349710918093,
    0.03676150313684809,
    0.0,
    0.0,
    0.0,
    0.00025025563671227915,
    0.2464748975981903,
    0.15181968960451941,
    0.0,
    0.0,
    0.0,
    0.0,
    0.06947649307880735,
    0.07429586430477829,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0005699980293894011,
    0.0014514046802272472,
    0.0,
    0.0,
    0.0,
    0.004106884511235088,
    0.018402948296092337,
    0.004240408508794833,
    0.0,
    0.0,
    0.0,
    0.008314296398562454,
    0.08766594386217699,
    0.0209742907059884,
    0.0,
    0.0,
    0.0,
    0.0002675485020888638,
    0.05388591103069893,
    0.018325067318377894,
    0.0,
    0.0,
    0.0,
    0.0,
    0.009221542220687313,
    0.010542486396821142,
    0.0,
    0.0,
    0.0,
    0.0007627289041655591,
    0.0033117716170016427,
    0.0007630986251752323,
    0.0,
    0.0,
    0.0,
    0.0005443155673502398,
    0.002630074393442275,
    0.0006060219078637586,
    0.0,
    0.0,
    0.0,
    0.0005230493887186678,
    0.005819945308141101,
    0.0014072994815802443,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0]).reshape(SHAPE)

RLZ_1_POE_01_SA = numpy.array([
    0.0160010291099169,
    0.1327324602189923,
    0.031488714290864014,
    0.0,
    0.0,
    0.0,
    0.0006161706753514591,
    0.26851865916304823,
    0.13765494767732464,
    0.0,
    0.0,
    0.0,
    0.0,
    0.08898438373130464,
    0.08546661363080768,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0018152133087751925,
    0.007047687185821367,
    0.0,
    0.0,
    0.0,
    0.0035638390988641322,
    0.015763370144251374,
    0.0036321967443205473,
    0.0,
    0.0,
    0.0,
    0.008997624215883163,
    0.07653384188315315,
    0.017965898865337317,
    0.0,
    0.0,
    0.0,
    0.0006894603904269112,
    0.05186120814492016,
    0.01569665981832117,
    0.0,
    0.0,
    0.0,
    0.0,
    0.011647813009826053,
    0.009030352780435416,
    0.0,
    0.0,
    0.0,
    0.0006535934726777126,
    0.002836756425768358,
    0.0006536455948072599,
    0.0,
    0.0,
    0.0,
    0.00048583923795424193,
    0.0022528366381136507,
    0.0005190987604529808,
    0.0,
    0.0,
    0.0,
    0.0005311379891668268,
    0.005153500585685734,
    0.001205447207427787,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0]).reshape(SHAPE)

RLZ_2_POE_01_SA = numpy.array([
    0.0160010291099169,
    0.1327324602189923,
    0.031488714290864014,
    0.0,
    0.0,
    0.0,
    0.0006161706753514591,
    0.26851865916304823,
    0.13765494767732464,
    0.0,
    0.0,
    0.0,
    0.0,
    0.08898438373130464,
    0.08546661363080768,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0018152133087751925,
    0.007047687185821367,
    0.0,
    0.0,
    0.0,
    0.0035638390988641322,
    0.015763370144251374,
    0.0036321967443205473,
    0.0,
    0.0,
    0.0,
    0.008997624215883163,
    0.07653384188315315,
    0.017965898865337317,
    0.0,
    0.0,
    0.0,
    0.0006894603904269112,
    0.05186120814492016,
    0.01569665981832117,
    0.0,
    0.0,
    0.0,
    0.0,
    0.011647813009826053,
    0.009030352780435416,
    0.0,
    0.0,
    0.0,
    0.0006535934726777126,
    0.002836756425768358,
    0.0006536455948072599,
    0.0,
    0.0,
    0.0,
    0.00048583923795424193,
    0.0022528366381136507,
    0.0005190987604529808,
    0.0,
    0.0,
    0.0,
    0.0005311379891668268,
    0.005153500585685734,
    0.001205447207427787,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0]).reshape(SHAPE)

#: In this test case, we test the export of a single result.
#: This is the expected XML output.
EXPECTED_XML_DISAGG = """\
<nrml xmlns:gml="http://www.opengis.net/gml" xmlns="http://openquake.org/xmlns/nrml/0.4">
  <disaggMatrices sourceModelTreePath="b1" gsimTreePath="b1" IMT="SA" investigationTime="50.0" saPeriod="0.025" saDamping="5.0" lon="10.1" lat="40.1" magBinEdges="5.0, 6.0, 7.0, 8.0" distBinEdges="0.0, 25.0, 50.0, 75.0, 100.0" lonBinEdges="9.0, 10.5, 12.0" latBinEdges="39.0, 40.5" epsBinEdges="-3.0, -1.0, 1.0, 3.0" tectonicRegionTypes="Active Shallow Crust">
    <disaggMatrix type="Mag" dims="3" poE="0.1" iml="0.0311513188906">
      <prob index="0" value="0.770325878992"/>
      <prob index="1" value="0.215382265096"/>
      <prob index="2" value="0.0142918559121"/>
    </disaggMatrix>
    <disaggMatrix type="Dist" dims="4" poE="0.1" iml="0.0311513188906">
      <prob index="0" value="0.2073256051"/>
      <prob index="1" value="0.513544917117"/>
      <prob index="2" value="0.249588411498"/>
      <prob index="3" value="0.0295410662849"/>
    </disaggMatrix>
    <disaggMatrix type="TRT" dims="1" poE="0.1" iml="0.0311513188906">
      <prob index="0" value="1.0"/>
    </disaggMatrix>
    <disaggMatrix type="Mag,Dist" dims="3,4" poE="0.1" iml="0.0311513188906">
      <prob index="0,0" value="0.18022220362"/>
      <prob index="0,1" value="0.406789777516"/>
      <prob index="0,2" value="0.174450997362"/>
      <prob index="0,3" value="0.0088629004946"/>
      <prob index="1,0" value="0.0229594059874"/>
      <prob index="1,1" value="0.103497364964"/>
      <prob index="1,2" value="0.0682473283537"/>
      <prob index="1,3" value="0.0206781657903"/>
      <prob index="2,0" value="0.00414399549325"/>
      <prob index="2,1" value="0.00325777463652"/>
      <prob index="2,2" value="0.00689008578228"/>
      <prob index="2,3" value="0.0"/>
    </disaggMatrix>
    <disaggMatrix type="Mag,Dist,Eps" dims="3,4,3" poE="0.1" iml="0.0311513188906">
      <prob index="0,0,0" value="0.0160010291099"/>
      <prob index="0,0,1" value="0.132732460219"/>
      <prob index="0,0,2" value="0.0314887142909"/>
      <prob index="0,1,0" value="0.000616170675351"/>
      <prob index="0,1,1" value="0.268518659163"/>
      <prob index="0,1,2" value="0.137654947677"/>
      <prob index="0,2,0" value="0.0"/>
      <prob index="0,2,1" value="0.0889843837313"/>
      <prob index="0,2,2" value="0.0854666136308"/>
      <prob index="0,3,0" value="0.0"/>
      <prob index="0,3,1" value="0.00181521330878"/>
      <prob index="0,3,2" value="0.00704768718582"/>
      <prob index="1,0,0" value="0.00356383909886"/>
      <prob index="1,0,1" value="0.0157633701443"/>
      <prob index="1,0,2" value="0.00363219674432"/>
      <prob index="1,1,0" value="0.00899762421588"/>
      <prob index="1,1,1" value="0.0765338418832"/>
      <prob index="1,1,2" value="0.0179658988653"/>
      <prob index="1,2,0" value="0.000689460390427"/>
      <prob index="1,2,1" value="0.0518612081449"/>
      <prob index="1,2,2" value="0.0156966598183"/>
      <prob index="1,3,0" value="0.0"/>
      <prob index="1,3,1" value="0.0116478130098"/>
      <prob index="1,3,2" value="0.00903035278044"/>
      <prob index="2,0,0" value="0.000653593472678"/>
      <prob index="2,0,1" value="0.00283675642577"/>
      <prob index="2,0,2" value="0.000653645594807"/>
      <prob index="2,1,0" value="0.000485839237954"/>
      <prob index="2,1,1" value="0.00225283663811"/>
      <prob index="2,1,2" value="0.000519098760453"/>
      <prob index="2,2,0" value="0.000531137989167"/>
      <prob index="2,2,1" value="0.00515350058569"/>
      <prob index="2,2,2" value="0.00120544720743"/>
      <prob index="2,3,0" value="0.0"/>
      <prob index="2,3,1" value="0.0"/>
      <prob index="2,3,2" value="0.0"/>
    </disaggMatrix>
    <disaggMatrix type="Lon,Lat" dims="2,1" poE="0.1" iml="0.0311513188906">
      <prob index="0,0" value="1.0"/>
      <prob index="1,0" value="0.0"/>
    </disaggMatrix>
    <disaggMatrix type="Mag,Lon,Lat" dims="3,2,1" poE="0.1" iml="0.0311513188906">
      <prob index="0,0,0" value="0.770325878992"/>
      <prob index="0,1,0" value="0.0"/>
      <prob index="1,0,0" value="0.215382265096"/>
      <prob index="1,1,0" value="0.0"/>
      <prob index="2,0,0" value="0.0142918559121"/>
      <prob index="2,1,0" value="0.0"/>
    </disaggMatrix>
    <disaggMatrix type="Lon,Lat,TRT" dims="2,1,1" poE="0.1" iml="0.0311513188906">
      <prob index="0,0,0" value="1.0"/>
      <prob index="1,0,0" value="0.0"/>
    </disaggMatrix>
  </disaggMatrices>
</nrml>
"""
