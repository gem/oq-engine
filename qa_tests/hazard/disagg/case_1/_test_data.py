# Copyright (c) 2010-2012, GEM Foundation.
#
# OpenQuake is free software: you can redistribute it and/or modify it
# under the terms of the GNU Affero General Public License as published
# by the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# OpenQuake is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with OpenQuake.  If not, see <http://www.gnu.org/licenses/>.

import numpy

#: Shape of the result matrices (which are numpy arrays)
SHAPE = (3, 4, 2, 1, 3, 1)

RLZ_1_POE_002_PGA = numpy.array([
    0.0,
    0.0,
    0.00843523268661,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.00171880124437,
    0.00514026075993,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    5.15425011227e-07,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.00138122940861,
    0.00178648007249,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    1.81516494375e-05,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
]).reshape(SHAPE)

RLZ_2_POE_002_PGA = numpy.array([
    0.0,
    0.0,
    0.00843523268661,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.00171880124437,
    0.00514026075993,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    5.15425011227e-07,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.00138122940861,
    0.00178648007249,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    1.81516494375e-05,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
]).reshape(SHAPE)

RLZ_1_POE_002_SA = numpy.array([
    0.0,
    0.0,
    0.00803016500637,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.00147497081406,
    0.00488424433012,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    3.14466200857e-08,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.00125691704723,
    0.00170034459931,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    1.56449786026e-05,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
]).reshape(SHAPE)

RLZ_2_POE_002_SA = numpy.array([
    0.0,
    0.0,
    0.00803016500637,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.00147497081406,
    0.00488424433012,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    3.14466200857e-08,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.00125691704723,
    0.00170034459931,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    1.56449786026e-05,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
]).reshape(SHAPE)

RLZ_1_POE_01_PGA = numpy.array([
    0.0,
    0.00991764750366,
    0.0436180329763,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.000220002754424,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    2.04630814324e-05,
    0.0133803184668,
    0.0140550516961,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.00383078932003,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    7.01116415169e-06,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.00013724876772,
    0.00577466776447,
    0.00347054457277,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.000563637509183,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.000141774745938,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
]).reshape(SHAPE)

RLZ_2_POE_01_PGA = numpy.array([
    0.0,
    0.00991764750366,
    0.0436180329763,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.000220002754424,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    2.04630814324e-05,
    0.0133803184668,
    0.0140550516961,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.00383078932003,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    7.01116415169e-06,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.00013724876772,
    0.00577466776447,
    0.00347054457277,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.000563637509183,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.000141774745938,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
]).reshape(SHAPE)

RLZ_1_POE_01_SA = numpy.array([
    0.0,
    0.00978618461228,
    0.0443237343228,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.000239448310408,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    7.81506091685e-06,
    0.0129385813413,
    0.0139851241654,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.00382004881632,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    7.04977702759e-06,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.000102305752503,
    0.00564195138932,
    0.00345755163733,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.000553036928267,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.000138583492116,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
]).reshape(SHAPE)

RLZ_2_POE_01_SA = numpy.array([
    0.0,
    0.00978618461228,
    0.0443237343228,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.000239448310408,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    7.81506091685e-06,
    0.0129385813413,
    0.0139851241654,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.00382004881632,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    7.04977702759e-06,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.000102305752503,
    0.00564195138932,
    0.00345755163733,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.000553036928267,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.000138583492116,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
]).reshape(SHAPE)

#: In this test case, we test the export of a single result.
#: This is the expected XML output.
EXPECTED_XML_DISAGG = """\
<?xml version='1.0' encoding='UTF-8'?>
<nrml xmlns:gml="http://www.opengis.net/gml" xmlns="http://openquake.org/xmlns/nrml/0.4">
  <disaggMatrices sourceModelTreePath="b1" gsimTreePath="b1" IMT="SA" investigationTime="50.0" saPeriod="0.025" saDamping="5.0" lon="10.1" lat="40.1" magBinEdges="5.0, 6.0, 7.0, 8.0" distBinEdges="0.0, 25.0, 50.0, 75.0, 100.0" lonBinEdges="9.0, 10.5, 12.0" latBinEdges="39.0, 40.5" epsBinEdges="-3.0, -1.0, 1.0, 3.0" tectonicRegionTypes="Active Shallow Crust">
    <disaggMatrix type="Mag" dims="3" poE="0.1" iml="0.35210289396">
      <prob index="0" value="0.0539027543332"/>
      <prob index="1" value="0.0304750600079"/>
      <prob index="2" value="0.00986656696266"/>
    </disaggMatrix>
    <disaggMatrix type="Dist" dims="4" poE="0.1" iml="0.35210289396">
      <prob index="0" value="0.0874467955929"/>
      <prob index="1" value="0.0046093748048"/>
      <prob index="2" value="0.00014563229216"/>
      <prob index="3" value="0.0"/>
    </disaggMatrix>
    <disaggMatrix type="TRT" dims="1" poE="0.1" iml="0.35210289396">
      <prob index="0" value="0.0917853799831"/>
    </disaggMatrix>
    <disaggMatrix type="Mag,Dist" dims="3,4" poE="0.1" iml="0.35210289396">
      <prob index="0,0" value="0.0536761586883"/>
      <prob index="0,1" value="0.000239448310408"/>
      <prob index="0,2" value="0.0"/>
      <prob index="0,3" value="0.0"/>
      <prob index="1,0" value="0.0267503639047"/>
      <prob index="1,1" value="0.00382004881632"/>
      <prob index="1,2" value="7.04977702759e-06"/>
      <prob index="1,3" value="0.0"/>
      <prob index="2,0" value="0.0091813725051"/>
      <prob index="2,1" value="0.000553036928267"/>
      <prob index="2,2" value="0.000138583492116"/>
      <prob index="2,3" value="0.0"/>
    </disaggMatrix>
    <disaggMatrix type="Mag,Dist,Eps" dims="3,4,3" poE="0.1" iml="0.35210289396">
      <prob index="0,0,0" value="0.0"/>
      <prob index="0,0,1" value="0.00978618461228"/>
      <prob index="0,0,2" value="0.0443237343228"/>
      <prob index="0,1,0" value="0.0"/>
      <prob index="0,1,1" value="0.0"/>
      <prob index="0,1,2" value="0.000239448310408"/>
      <prob index="0,2,0" value="0.0"/>
      <prob index="0,2,1" value="0.0"/>
      <prob index="0,2,2" value="0.0"/>
      <prob index="0,3,0" value="0.0"/>
      <prob index="0,3,1" value="0.0"/>
      <prob index="0,3,2" value="0.0"/>
      <prob index="1,0,0" value="7.81506091685e-06"/>
      <prob index="1,0,1" value="0.0129385813413"/>
      <prob index="1,0,2" value="0.0139851241654"/>
      <prob index="1,1,0" value="0.0"/>
      <prob index="1,1,1" value="0.0"/>
      <prob index="1,1,2" value="0.00382004881632"/>
      <prob index="1,2,0" value="0.0"/>
      <prob index="1,2,1" value="0.0"/>
      <prob index="1,2,2" value="7.04977702759e-06"/>
      <prob index="1,3,0" value="0.0"/>
      <prob index="1,3,1" value="0.0"/>
      <prob index="1,3,2" value="0.0"/>
      <prob index="2,0,0" value="0.000102305752503"/>
      <prob index="2,0,1" value="0.00564195138932"/>
      <prob index="2,0,2" value="0.00345755163733"/>
      <prob index="2,1,0" value="0.0"/>
      <prob index="2,1,1" value="0.0"/>
      <prob index="2,1,2" value="0.000553036928267"/>
      <prob index="2,2,0" value="0.0"/>
      <prob index="2,2,1" value="0.0"/>
      <prob index="2,2,2" value="0.000138583492116"/>
      <prob index="2,3,0" value="0.0"/>
      <prob index="2,3,1" value="0.0"/>
      <prob index="2,3,2" value="0.0"/>
    </disaggMatrix>
    <disaggMatrix type="Lon,Lat" dims="2,1" poE="0.1" iml="0.35210289396">
      <prob index="0,0" value="0.0917853799831"/>
      <prob index="1,0" value="0.0"/>
    </disaggMatrix>
    <disaggMatrix type="Mag,Lon,Lat" dims="3,2,1" poE="0.1" iml="0.35210289396">
      <prob index="0,0,0" value="0.0539027543332"/>
      <prob index="0,1,0" value="0.0"/>
      <prob index="1,0,0" value="0.0304750600079"/>
      <prob index="1,1,0" value="0.0"/>
      <prob index="2,0,0" value="0.00986656696266"/>
      <prob index="2,1,0" value="0.0"/>
    </disaggMatrix>
    <disaggMatrix type="Lon,Lat,TRT" dims="2,1,1" poE="0.1" iml="0.35210289396">
      <prob index="0,0,0" value="0.0917853799831"/>
      <prob index="1,0,0" value="0.0"/>
    </disaggMatrix>
  </disaggMatrices>
</nrml>
"""
