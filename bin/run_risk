#!/usr/bin/env python

import sys
import argparse
import logging
from concurrent.futures import ProcessPoolExecutor
from openquake.risklite.parallel import run_calc, Runner

if __name__ == '__main__':
    p = argparse.ArgumentParser()
    p.add_argument('path', help="The path to a directory or zip archive")
    p.add_argument('config', help=".ini file inside the directory/archive")
    arg = p.parse_args()
    logging.basicConfig(level=logging.INFO)
    with ProcessPoolExecutor() as ppe:
        run_calc(arg.path, Runner([], ppe), arg.config)
