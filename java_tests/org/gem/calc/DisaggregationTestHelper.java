package org.gem.calc;

import java.rmi.RemoteException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.opensha.commons.data.Site;
import org.opensha.commons.data.function.ArbitrarilyDiscretizedFunc;
import org.opensha.commons.data.function.DiscretizedFuncAPI;
import org.opensha.commons.geo.BorderType;
import org.opensha.commons.geo.Location;
import org.opensha.commons.geo.LocationList;
import org.opensha.commons.geo.Region;
import org.opensha.commons.param.DoubleParameter;
import org.opensha.sha.calc.HazardCurveCalculator;
import org.opensha.sha.earthquake.EqkRupForecast;
import org.opensha.sha.earthquake.FocalMechanism;
import org.opensha.sha.earthquake.ProbEqkRupture;
import org.opensha.sha.earthquake.ProbEqkSource;
import org.opensha.sha.earthquake.griddedForecast.MagFreqDistsForFocalMechs;
import org.opensha.sha.earthquake.rupForecastImpl.GEM1.GEM1ERF;
import org.opensha.sha.earthquake.rupForecastImpl.GEM1.SourceData.GEMAreaSourceData;
import org.opensha.sha.earthquake.rupForecastImpl.GEM1.SourceData.GEMSourceData;
import org.opensha.sha.faultSurface.EvenlyGriddedSurfaceAPI;
import org.opensha.sha.imr.ScalarIntensityMeasureRelationshipAPI;
import org.opensha.sha.imr.attenRelImpl.BA_2008_AttenRel;
import org.opensha.sha.imr.attenRelImpl.CB_2008_AttenRel;
import org.opensha.sha.imr.param.IntensityMeasureParams.PGA_Param;
import org.opensha.sha.imr.param.OtherParams.ComponentParam;
import org.opensha.sha.imr.param.OtherParams.SigmaTruncLevelParam;
import org.opensha.sha.imr.param.OtherParams.SigmaTruncTypeParam;
import org.opensha.sha.imr.param.OtherParams.StdDevTypeParam;
import org.opensha.sha.imr.param.SiteParams.DepthTo2pt5kmPerSecParam;
import org.opensha.sha.imr.param.SiteParams.Vs30_Param;
import org.opensha.sha.magdist.GutenbergRichterMagFreqDist;
import org.opensha.sha.util.TectonicRegionType;

public class DisaggregationTestHelper
{
	public static final Double[] LAT_BIN_LIMS = {-0.6, -0.3, -0.1, 0.1, 0.3, 0.6};
	public static final Double[] LON_BIN_LIMS = {-0.6, -0.3, -0.1, 0.1, 0.3, 0.6};
	public static final Double[] MAG_BIN_LIMS = {5.0, 6.0, 7.0, 8.0, 9.0};
	public static final Double[] EPS_BIN_LIMS = {-3.5, -2.5, -1.5, -0.5, 0.5, 1.5, 2.5, 3.5};
	public static final double POE = 0.1;
	public static final List<Double> IMLS = 
			Arrays.asList(mapLog(new Double[] {
				0.005, 0.007, 0.0098, 0.0137, 0.0192, 0.0269,
				0.0376, 0.0527, 0.0738, 0.103, 0.145, 0.203,
				0.284, 0.397, 0.556, 0.778, 1.09, 1.52, 2.13}));

	/**
	 * This test data was generated from the calculator prototype test code
	 * provided by Damiano Monelli. This matrix was calculated used the
	 * 'disaggregate' method:
	 * https://github.com/monellid/shaCalcs/blob/master/src/DisaggregationCalculator.java#L120
	 */
	public static final double[][][][][] EXPECTED =
	{
	    {
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 9.669152009560643E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 1.0616609669228113E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 4.2995095466506015E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 6.457707206488213E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 1.2435319539082669E-5,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 3.4617444212360014E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 3.6368767266456825E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0012459444040409675,  0.0,  0.0,  0.0,  0.0, },
	            { 2.548321856309011E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 8.741799472451693E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0011840513111399209,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 1.3056453040865776E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 5.792952928825489E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 9.23678330289433E-5,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 1.939990061916687E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0033251990621705643,  0.0,  0.0,  0.0,  0.0, },
	            { 3.4058605686597393E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0028793066928817757,  0.0,  0.0,  0.0,  0.0, },
	            { 6.487267940023882E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 4.3032106032285283E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 5.287479616205522E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 2.967800526504125E-5,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0024264834707687062,  0.0,  0.0,  0.0,  0.0, },
	            { 3.6235238406271466E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0020063165098749844,  0.0,  0.0,  0.0,  0.0, },
	            { 9.171586478268859E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 2.806313497765432E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 5.836836282074048E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 4.6044866987340823E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 1.656385183192196E-4,  3.970501626916313E-7,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 2.753543927231999E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 9.952472517089565E-4,  5.7300531075943845E-5,  0.0,  0.0,  0.0, },
	            { 0.0,  2.03572877855312E-5,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 3.313122427028471E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 5.058576553670275E-4,  2.5843297369569954E-5,  0.0,  0.0,  0.0, },
	            { 0.0,  5.140166347950952E-5,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	    },
	    {
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 6.178036364347683E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 2.081150601313141E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 4.3876322643040015E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.001044242908184391,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 5.352193043016451E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 5.358570769367782E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 4.225039037140641E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 3.78079832805577E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0021696912566603836,  0.0,  0.0,  0.0,  0.0, },
	            { 0.005638425914342692,  0.0,  0.0,  0.0,  0.0, },
	            { 3.156653075710666E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 1.8220234297659666E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.004905444802980525,  0.0,  0.0,  0.0,  0.0, },
	            { 3.0023847573504465E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 8.646255014733539E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 3.3849225605003634E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.00465311226798915,  0.0,  0.0,  0.0,  0.0, },
	            { 0.01704861540697584,  0.0,  0.0,  0.0,  0.0, },
	            { 0.001647381716558733,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0038370527565503142,  0.0,  0.0,  0.0,  0.0, },
	            { 0.02899237566190449,  0.0,  0.0,  0.0,  0.0, },
	            { 0.005414704129983072,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.007739775242846785,  0.0,  0.0,  0.0,  0.0, },
	            { 0.00502035012832582,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 1.9327377244640132E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.001666453507455484,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0055593455255427745,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0011452141301549988,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.013420056885586918,  0.0,  0.0,  0.0,  0.0, },
	            { 0.007147092371589439,  0.0,  0.0,  0.0,  0.0, },
	            { 1.0141378322094631E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0027340464006314394,  0.0,  0.0,  0.0,  0.0, },
	            { 0.006361966286487675,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 4.030110203014131E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0014771869922857643,  0.0,  0.0,  0.0,  0.0, },
	            { 5.595406470906133E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 2.9686106228229175E-5,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0024266120093396786,  0.0,  0.0,  0.0,  0.0, },
	            { 3.6238677529290233E-4,  1.7004495038753674E-5,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.002006391789536035,  0.0,  0.0,  0.0,  0.0, },
	            { 9.171986304526499E-4,  1.506703482017999E-4,  0.0,  0.0,  0.0, },
	            { 0.0,  3.064611419926655E-5,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 2.8063810405245105E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 5.837015582422732E-4,  6.418199359420848E-5,  0.0,  0.0,  0.0, },
	            { 0.0,  5.186775820980598E-5,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	    },
	    {
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 8.883144195206736E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 2.1106857231025089E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 6.135521955874665E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0011262754501763295,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 8.564205374739845E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 5.602375655498687E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0013274499352831075,  0.0,  0.0,  0.0,  0.0, },
	            { 6.186560072112841E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.005168171095518152,  0.0,  0.0,  0.0,  0.0, },
	            { 0.006871040924668189,  0.0,  0.0,  0.0,  0.0, },
	            { 1.973405367896878E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 6.627581985749021E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.006176586020061532,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0011396593139751463,  0.0,  0.0,  0.0,  0.0, },
	            { 2.2429802661411602E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.07347313940931072,  0.0,  0.0,  0.0,  0.0, },
	            { 0.4007774720000059,  0.0,  0.0,  0.0,  0.0, },
	            { 0.009308218812576716,  0.0,  0.0,  0.0,  0.0, },
	            { 0.026736215877429446,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0016787880495174017,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.07877863624842021,  0.0,  0.0,  0.0,  0.0, },
	            { 0.007674859547269292,  0.0,  0.0,  0.0,  0.0, },
	            { 0.038490902880478316,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0011382602500840618,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.00931680853091606,  0.0,  0.0,  0.0,  0.0, },
	            { 0.01178525598425748,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0011935611006132594,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0011254862137668473,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0012853702692607117,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.004653781694867176,  0.0,  0.0,  0.0,  0.0, },
	            { 0.01705214289784068,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0016480633284743766,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.003837307985146771,  0.0,  0.0,  0.0,  0.0, },
	            { 0.028995375853095577,  0.0,  0.0,  0.0,  0.0, },
	            { 0.005415398609930636,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.007740171101248287,  0.0,  0.0,  0.0,  0.0, },
	            { 0.00502067488342177,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 1.9327711020099983E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.001666503829893714,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 9.240049995427375E-5,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 1.940133477580891E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0033255400004863,  0.0,  0.0,  0.0,  0.0, },
	            { 3.406505442022494E-4,  2.914054119241691E-5,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.002879499126392456,  0.0,  0.0,  0.0,  0.0, },
	            { 6.487821759914304E-4,  1.9385381623450356E-4,  0.0,  0.0,  0.0, },
	            { 0.0,  2.290875636246098E-5,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 4.303380606017015E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 5.287757490160441E-4,  8.434709317041775E-5,  0.0,  0.0,  0.0, },
	            { 0.0,  4.2891126277676975E-5,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	    },
	    {
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 3.066395804465564E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 1.6426216385789202E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 1.8625919794670417E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 9.038419781587828E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 1.9164804218183084E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 4.62440615642858E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 1.1997828077453369E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 1.163230300848607E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 4.711674490638383E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.00310056707227807,  0.0,  0.0,  0.0,  0.0, },
	            { 3.419080964151779E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0026127086054770036,  0.0,  0.0,  0.0,  0.0, },
	            { 9.272220641754556E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 4.452165157917744E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 5.145350986003036E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0013275952357783163,  0.0,  0.0,  0.0,  0.0, },
	            { 6.187850271344048E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0051684298949988645,  0.0,  0.0,  0.0,  0.0, },
	            { 0.006871448733294777,  0.0,  0.0,  0.0,  0.0, },
	            { 1.9735932839967045E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 6.627732189090563E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.006176760032152354,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0011396702486781939,  0.0,  0.0,  0.0,  0.0, },
	            { 2.243004160765154E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 4.2258014077859504E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 3.7821556852696866E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0021698712574499,  0.0,  0.0,  0.0,  0.0, },
	            { 0.005639039240240125,  0.0,  0.0,  0.0,  0.0, },
	            { 3.1572490849865096E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 1.8220925965033776E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0049057272228490495,  0.0,  0.0,  0.0,  0.0, },
	            { 3.002597846441174E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 8.646479269072765E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 3.385029958997479E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0012460858883700248,  0.0,  0.0,  0.0,  0.0, },
	            { 2.548888478703988E-4,  5.022601136610496E-6,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 8.742385291218049E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0011841536059880584,  1.0091716990401554E-4,  0.0,  0.0,  0.0, },
	            { 0.0,  2.7313376803588898E-5,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 1.3056928976788894E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 5.793247049525947E-4,  4.4751626046246235E-5,  0.0,  0.0,  0.0, },
	            { 0.0,  5.291417911822951E-5,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	    },
	    {
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 1.385498508735619E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 4.714235219549023E-5,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 3.571668863942673E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 3.987421260064655E-5,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 2.0166941039637256E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 7.482350505799457E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 3.066434115626027E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 1.6426783048280493E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 1.862589671699069E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 9.038434254390749E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 1.9164633690586087E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 4.624367695710272E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 1.1997704408343387E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 8.88351485767199E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 2.1109143288168433E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 6.135591283200592E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0011262979059189914,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 8.564162909786466E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 5.602357488193344E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 6.178479658566057E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 2.081496043476492E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 4.387761290726485E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0010442893990907911,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 5.352219934689823E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 5.358634531251811E-4,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	        {
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 9.670149336869655E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 1.0618549547756303E-4,  0.0,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 4.299710092859563E-5,  0.0,  0.0,  0.0,  0.0, },
	            { 6.458150234710156E-4,  2.6199327260408505E-5,  0.0,  0.0,  0.0, },
	            { 1.2436802481100202E-5,  1.527063143117085E-5,  0.0,  0.0,  0.0, },
	            },
	            {{ 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            { 3.461860368087821E-4,  1.2065900308674362E-5,  0.0,  0.0,  0.0, },
	            { 3.6370231141708915E-5,  4.6466913484651594E-5,  0.0,  0.0,  0.0, },
	            { 0.0,  0.0,  0.0,  0.0,  0.0, },
	            },
	        },
	    },
	};


	/**
	 * Map the Math.log() method to each element in the input list
	 * to create a new list.
	 */
	private static Double[] mapLog(Double[] list)
	{
		Double[] result = new Double[list.length];
		for (int i = 0; i < list.length; i++)
		{
			result[i] = Math.log(list[i]);
		}
		return result;
	}
	
	public static Site makeTestSite()
	{
		Site site = new Site(new Location(0.0, 0.0));
		site.addParameter(new DoubleParameter(Vs30_Param.NAME, 760.0));
		site.addParameter(new DoubleParameter(DepthTo2pt5kmPerSecParam.NAME, 1.0));
		return site;
	}

	public static Map<TectonicRegionType, ScalarIntensityMeasureRelationshipAPI> makeTestImrMap()
	{
		Map<TectonicRegionType, ScalarIntensityMeasureRelationshipAPI> imrMap = new HashMap<TectonicRegionType, ScalarIntensityMeasureRelationshipAPI>();
		imrMap.put(TectonicRegionType.ACTIVE_SHALLOW, getTestIMRActiveShallow());
		imrMap.put(TectonicRegionType.STABLE_SHALLOW, getTestIMRStableContinental());
		return imrMap;
	}

	public static Map<TectonicRegionType, ScalarIntensityMeasureRelationshipAPI> makeTestImrMapZeroStdDev()
	{
		Map<TectonicRegionType, ScalarIntensityMeasureRelationshipAPI> imrMap = new HashMap<TectonicRegionType, ScalarIntensityMeasureRelationshipAPI>();
		ScalarIntensityMeasureRelationshipAPI imr = new BA_2008_AttenRel(null);
		imr.getParameter(StdDevTypeParam.NAME).setValue(
				StdDevTypeParam.STD_DEV_TYPE_NONE);
		imrMap.put(TectonicRegionType.ACTIVE_SHALLOW, imr);
		return imrMap;
	}

	private static ScalarIntensityMeasureRelationshipAPI getTestIMRActiveShallow()
	{
		ScalarIntensityMeasureRelationshipAPI imr = new BA_2008_AttenRel(null);
		setDefaultImrParams(imr);
		return imr;
	}

	private static ScalarIntensityMeasureRelationshipAPI getTestIMRStableContinental()
	{
		ScalarIntensityMeasureRelationshipAPI imr = new CB_2008_AttenRel(null);
		setDefaultImrParams(imr);
		return imr;
	}

	private static void setDefaultImrParams(ScalarIntensityMeasureRelationshipAPI imr)
	{
		imr.setIntensityMeasure(PGA_Param.NAME);
		imr.getParameter(StdDevTypeParam.NAME).setValue(
				StdDevTypeParam.STD_DEV_TYPE_TOTAL);
		imr.getParameter(SigmaTruncTypeParam.NAME).setValue(
				SigmaTruncTypeParam.SIGMA_TRUNC_TYPE_2SIDED);
		imr.getParameter(SigmaTruncLevelParam.NAME).setValue(3.0);
		imr.getParameter(ComponentParam.NAME).setValue(
				ComponentParam.COMPONENT_GMRotI50);
	}

	public static GEM1ERF makeTestERF()
	{
		ArrayList<GEMSourceData> srcList = new ArrayList<GEMSourceData>();
		srcList.add(makeTestSourceDataActiveShallow());
		srcList.add(makeTestSourceDataStableCrust());

		double timeSpan = 50.0;
		return GEM1ERF.getGEM1ERF(srcList, timeSpan);
	}

	private static GEMSourceData makeTestSourceDataActiveShallow()
	{
		String id = "src1";
		String name = "testSource";
		TectonicRegionType tectReg = TectonicRegionType.ACTIVE_SHALLOW;

		LocationList border = new LocationList();
		border.add(new Location(-0.5, -0.5));
		border.add(new Location(0.5, -0.5));
		border.add(new Location(0.5, 0.5));
		border.add(new Location(-0.5, 0.5));
		Region reg = new Region(border, BorderType.GREAT_CIRCLE);

		double bValue = 1.0;
		double totCumRate = 0.2;
		double min = 5.05;
		double max = 8.95;
		int num = 41;
		GutenbergRichterMagFreqDist magDist = new GutenbergRichterMagFreqDist(
				bValue, totCumRate, min, max, num);

		double strike = 0.0;
		double dip = 90.0;
		double rake = 0.0;
		FocalMechanism focalMechanism = new FocalMechanism(strike, dip, rake);

		MagFreqDistsForFocalMechs magfreqDistFocMech = new MagFreqDistsForFocalMechs(
				magDist, focalMechanism);

		ArbitrarilyDiscretizedFunc aveRupTopVsMag = new ArbitrarilyDiscretizedFunc();
		double magThreshold = 6.5;
		double topOfRuptureDepth = 0.0;
		aveRupTopVsMag.set(magThreshold, topOfRuptureDepth);
		double aveHypoDepth = 5.0;

		GEMSourceData srcData = new GEMAreaSourceData(id, name, tectReg, reg,
				magfreqDistFocMech, aveRupTopVsMag, aveHypoDepth);
		return srcData;
	}

	private static GEMSourceData makeTestSourceDataStableCrust()
	{
		String id = "src1";
		String name = "testSource";
		TectonicRegionType tectReg = TectonicRegionType.STABLE_SHALLOW;

		LocationList border = new LocationList();
		border.add(new Location(-0.5, 0.5));
		border.add(new Location(0.5, 0.5));
		border.add(new Location(0.5, 1.5));
		border.add(new Location(-0.5, 1.5));
		Region reg = new Region(border, BorderType.GREAT_CIRCLE);

		double bValue = 1.0;
		double totCumRate = 0.2;
		double min = 5.05;
		double max = 8.95;
		int num = 41;
		GutenbergRichterMagFreqDist magDist = new GutenbergRichterMagFreqDist(
				bValue, totCumRate, min, max, num);

		double strike = 0.0;
		double dip = 90.0;
		double rake = 0.0;
		FocalMechanism focalMechanism = new FocalMechanism(strike, dip, rake);

		MagFreqDistsForFocalMechs magfreqDistFocMech = new MagFreqDistsForFocalMechs(
				magDist, focalMechanism);

		ArbitrarilyDiscretizedFunc aveRupTopVsMag = new ArbitrarilyDiscretizedFunc();
		double magThreshold = 6.5;
		double topOfRuptureDepth = 0.0;
		aveRupTopVsMag.set(magThreshold, topOfRuptureDepth);
		double aveHypoDepth = 5.0;

		GEMSourceData srcData = new GEMAreaSourceData(id, name, tectReg, reg,
				magfreqDistFocMech, aveRupTopVsMag, aveHypoDepth);
		return srcData;
	}

	public static DiscretizedFuncAPI makeHazardCurve()
	{
		DiscretizedFuncAPI hazardCurve = new ArbitrarilyDiscretizedFunc();
		// initialize the curve our defined list of IMLs,
		// set the corresponding PoEs to 0.0
		for (double d : IMLS)
		{
			hazardCurve.set(d, 0.0);
		}
		try {
			HazardCurveCalculator hcc = new HazardCurveCalculator();
			hcc.getHazardCurve(hazardCurve, makeTestSite(), makeTestImrMap(), makeTestERF());
		} catch (RemoteException e) {
			throw new RuntimeException(e);
		}
		return hazardCurve;
	}

}
